{\rtf1\ansi\ansicpg1252\cocoartf2761
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 Menlo-Regular;}
{\colortbl;\red255\green255\blue255;\red21\green98\blue39;\red246\green247\blue249;\red46\green49\blue51;
\red42\green42\blue42;\red20\green67\blue174;\red24\green25\blue27;\red77\green80\blue85;\red162\green0\blue16;
\red186\green6\blue115;\red18\green115\blue126;}
{\*\expandedcolortbl;;\cssrgb\c7451\c45098\c20000;\cssrgb\c97255\c97647\c98039;\cssrgb\c23529\c25098\c26275;
\cssrgb\c21961\c21961\c21961;\cssrgb\c9412\c35294\c73725;\cssrgb\c12549\c12941\c14118;\cssrgb\c37255\c38824\c40784;\cssrgb\c70196\c7843\c7059;
\cssrgb\c78824\c15294\c52549;\cssrgb\c3529\c52157\c56863;}
\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\deftab720
\pard\pardeftab720\partightenfactor0

\f0\fs26 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 <!--\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * File: script.html\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  *   This client-side script file contains all the JavaScript code for the custom purchase\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  *   request web app. It handles user interactions, form navigation, data collection, preview\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  *   updates, conditional logic based on user inputs, and communication with the server-side\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  *   scripts in Code.gs using google.script.run.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  *\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Relationship with Other Files:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  *   - index.html: Defines the HTML structure that includes this script file using the include()\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  *     function. Defines the HTML elements that this script interacts with.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  *   - Code.gs: Contains server-side functions that process form submissions and provide data\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  *     for dropdowns and other dynamic elements.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  *   - style.html: Contains CSS styles that define the appearance of the web app.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  *\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Data Framework:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  *   - Uses a global JavaScript object (formData) to store form data collected from the user.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  *   - Updates the submission preview based on formData.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  *   - Sends formData to the server-side processForm(data) function for validation and storage.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  *\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Author: [Your Name]\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Date: [Date]\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  *******************************************************************************************/\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2 -->\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 <\cf6 \strokec6 script\cf5 \strokec5 >\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Global Variables\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Variables that are accessible throughout the script, used to store form data and track\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   the current section.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 let\cf4 \strokec4  \cf7 \strokec7 formData\cf4 \strokec4  = \{\cb1 \
\cb3     \cf7 \strokec7 requiresSection4\cf4 \strokec4 : \cf6 \strokec6 false\cf4 \strokec4 , \cf8 \strokec8 // Initialize to false\cf4 \cb1 \strokec4 \
\cb3   \}; \cf8 \strokec8 // Object to store form data collected from the user\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 let\cf4 \strokec4  \cf7 \strokec7 currentSectionId\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ; \cf8 \strokec8 // Tracks the currently active section\cf4 \cb1 \strokec4 \
\cb3   \cf8 \strokec8 // Add this at the global variables section at the top of script.html:\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 let\cf4 \strokec4  \cf7 \strokec7 sectionsWithErrors\cf4 \strokec4  = \cf6 \strokec6 new\cf4 \strokec4  \cf10 \strokec10 Set\cf4 \strokec4 ();\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 // Add these new functions after your existing global variables:\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 /**\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Validates all form fields before submission\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  */\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 validateFormBeforeSubmit\cf4 \strokec4 () \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 requiredFields\cf4 \strokec4  = \{\cb1 \
\cb3     \cf7 \strokec7 section1\cf4 \strokec4 : [\cf9 \strokec9 'requestorName'\cf4 \strokec4 , \cf9 \strokec9 'department'\cf4 \strokec4 , \cf9 \strokec9 'requestorEmail'\cf4 \strokec4 , \cf9 \strokec9 'requestShortDescription'\cf4 \strokec4 ],\cb1 \
\cb3     \cf7 \strokec7 section2\cf4 \strokec4 : [\cf9 \strokec9 'projectCategory'\cf4 \strokec4 , \cf9 \strokec9 'acquiringOrganization'\cf4 \strokec4 , \cf9 \strokec9 'currency'\cf4 \strokec4 , \cf9 \strokec9 'paymentFormat'\cf4 \strokec4 ],\cb1 \
\cb3     \cf7 \strokec7 section3\cf4 \strokec4 : [\cf9 \strokec9 'siteLocation'\cf4 \strokec4 , \cf9 \strokec9 'expenseType'\cf4 \strokec4 ],\cb1 \
\cb3     \cf7 \strokec7 section4\cf4 \strokec4 : \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 requiresSection4\cf4 \strokec4  ? [\cf9 \strokec9 'vehicleSelection'\cf4 \strokec4 ] : [],\cb1 \
\cb3     \cf7 \strokec7 section5\cf4 \strokec4 : [\cf9 \strokec9 'approvedBudget'\cf4 \strokec4 , \cf9 \strokec9 'deadlineDate'\cf4 \strokec4 ],\cb1 \
\cb3     \cf7 \strokec7 lineItemsSection\cf4 \strokec4 : [], \cf8 \strokec8 // Checked separately\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 sectionAdditionalInfo\cf4 \strokec4 : [\cf9 \strokec9 'vendor'\cf4 \strokec4 , \cf9 \strokec9 'urgencyStatus'\cf4 \strokec4 , \cf9 \strokec9 'approverSelection'\cf4 \strokec4 ]\cb1 \
\cb3   \};\cb1 \
\
\cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 errors\cf4 \strokec4  = \{\cb1 \
\cb3     \cf7 \strokec7 sections\cf4 \strokec4 : \cf6 \strokec6 new\cf4 \strokec4  \cf10 \strokec10 Set\cf4 \strokec4 (),\cb1 \
\cb3     \cf7 \strokec7 fields\cf4 \strokec4 : \cf6 \strokec6 new\cf4 \strokec4  \cf10 \strokec10 Set\cf4 \strokec4 ()\cb1 \
\cb3   \};\cb1 \
\
\cb3   \cf8 \strokec8 // Validate each section's required fields\cf4 \cb1 \strokec4 \
\cb3   \cf10 \strokec10 Object\cf4 \strokec4 .\cf7 \strokec7 entries\cf4 \strokec4 (\cf7 \strokec7 requiredFields\cf4 \strokec4 ).\cf7 \strokec7 forEach\cf4 \strokec4 (([\cf7 \strokec7 section\cf4 \strokec4 , \cf7 \strokec7 fields\cf4 \strokec4 ]) => \{\cb1 \
\cb3     \cf7 \strokec7 fields\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 field\cf4 \strokec4  => \{\cb1 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 formData\cf4 \strokec4 [\cf7 \strokec7 field\cf4 \strokec4 ];\cb1 \
\cb3       \cf6 \strokec6 if\cf4 \strokec4  (!\cf7 \strokec7 value\cf4 \strokec4  || \cf7 \strokec7 value\cf4 \strokec4 .\cf7 \strokec7 toString\cf4 \strokec4 ().\cf7 \strokec7 trim\cf4 \strokec4 () === \cf9 \strokec9 ''\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 errors\cf4 \strokec4 .\cf7 \strokec7 sections\cf4 \strokec4 .\cf7 \strokec7 add\cf4 \strokec4 (\cf7 \strokec7 section\cf4 \strokec4 );\cb1 \
\cb3         \cf7 \strokec7 errors\cf4 \strokec4 .\cf7 \strokec7 fields\cf4 \strokec4 .\cf7 \strokec7 add\cf4 \strokec4 (\cf7 \strokec7 field\cf4 \strokec4 );\cb1 \
\cb3       \}\cb1 \
\cb3     \});\cb1 \
\cb3   \});\cb1 \
\
\cb3   \cf8 \strokec8 // Special validation for line items\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 if\cf4 \strokec4  (!\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4  || \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  === \cf11 \strokec11 0\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf7 \strokec7 errors\cf4 \strokec4 .\cf7 \strokec7 sections\cf4 \strokec4 .\cf7 \strokec7 add\cf4 \strokec4 (\cf9 \strokec9 'lineItemsSection'\cf4 \strokec4 );\cb1 \
\cb3   \} \cf6 \strokec6 else\cf4 \strokec4  \{\cb1 \
\cb3     \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 ((\cf7 \strokec7 item\cf4 \strokec4 , \cf7 \strokec7 index\cf4 \strokec4 ) => \{\cb1 \
\cb3       \cf6 \strokec6 if\cf4 \strokec4  (!\cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 item\cf4 \strokec4  || !\cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 qty\cf4 \strokec4  || !\cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 uom\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 errors\cf4 \strokec4 .\cf7 \strokec7 sections\cf4 \strokec4 .\cf7 \strokec7 add\cf4 \strokec4 (\cf9 \strokec9 'lineItemsSection'\cf4 \strokec4 );\cb1 \
\cb3       \}\cb1 \
\cb3     \});\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf6 \strokec6 return\cf4 \strokec4  \{\cb1 \
\cb3     \cf7 \strokec7 isValid\cf4 \strokec4 : \cf7 \strokec7 errors\cf4 \strokec4 .\cf7 \strokec7 sections\cf4 \strokec4 .\cf7 \strokec7 size\cf4 \strokec4  === \cf11 \strokec11 0\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 errors\cf4 \strokec4 : \cf7 \strokec7 errors\cf4 \cb1 \strokec4 \
\cb3   \};\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 /**\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Updates the UI to show validation errors\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  */\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 updateValidationUI\cf4 \strokec4 (\cf7 \strokec7 errors\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf7 \strokec7 sectionsWithErrors\cf4 \strokec4  = \cf7 \strokec7 errors\cf4 \strokec4 .\cf7 \strokec7 sections\cf4 \strokec4 ; \cf8 \strokec8 // Store current error sections\cf4 \cb1 \strokec4 \
\cb3   \cb1 \
\cb3   \cf8 \strokec8 // Reset all section buttons to default style\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 allButtons\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 querySelectorAll\cf4 \strokec4 (\cf9 \strokec9 '#sectionMenu button'\cf4 \strokec4 );\cb1 \
\cb3   \cf7 \strokec7 allButtons\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 button\cf4 \strokec4  => \{\cb1 \
\cb3     \cf6 \strokec6 if\cf4 \strokec4  (!\cf7 \strokec7 button\cf4 \strokec4 .\cf7 \strokec7 disabled\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf7 \strokec7 button\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 backgroundColor\cf4 \strokec4  = \cf9 \strokec9 'blue'\cf4 \strokec4 ;\cb1 \
\cb3       \cf7 \strokec7 button\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 color\cf4 \strokec4  = \cf9 \strokec9 'white'\cf4 \strokec4 ;\cb1 \
\cb3     \}\cb1 \
\cb3   \});\cb1 \
\
\cb3   \cf8 \strokec8 // Highlight sections with errors\cf4 \cb1 \strokec4 \
\cb3   \cf7 \strokec7 errors\cf4 \strokec4 .\cf7 \strokec7 sections\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4  => \{\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 button\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 querySelector\cf4 \strokec4 (\cf9 \strokec9 `#sectionMenu button[onclick="showSection('\cf4 \strokec4 $\{\cf7 \strokec7 sectionId\cf4 \strokec4 \}\cf9 \strokec9 ')"]`\cf4 \strokec4 );\cb1 \
\cb3     \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 button\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf7 \strokec7 button\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 backgroundColor\cf4 \strokec4  = \cf9 \strokec9 'red'\cf4 \strokec4 ;\cb1 \
\cb3       \cf7 \strokec7 button\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 color\cf4 \strokec4  = \cf9 \strokec9 'black'\cf4 \strokec4 ;\cb1 \
\cb3     \}\cb1 \
\cb3   \});\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 /**\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Validates a single section\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  */\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 validateSection\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 requiredFields\cf4 \strokec4  = \{\cb1 \
\cb3     \cf7 \strokec7 section1\cf4 \strokec4 : [\cf9 \strokec9 'requestorName'\cf4 \strokec4 , \cf9 \strokec9 'department'\cf4 \strokec4 , \cf9 \strokec9 'requestorEmail'\cf4 \strokec4 , \cf9 \strokec9 'requestShortDescription'\cf4 \strokec4 ],\cb1 \
\cb3     \cf7 \strokec7 section2\cf4 \strokec4 : [\cf9 \strokec9 'projectCategory'\cf4 \strokec4 , \cf9 \strokec9 'acquiringOrganization'\cf4 \strokec4 , \cf9 \strokec9 'currency'\cf4 \strokec4 , \cf9 \strokec9 'paymentFormat'\cf4 \strokec4 ],\cb1 \
\cb3     \cf7 \strokec7 section3\cf4 \strokec4 : [\cf9 \strokec9 'siteLocation'\cf4 \strokec4 , \cf9 \strokec9 'expenseType'\cf4 \strokec4 ],\cb1 \
\cb3     \cf7 \strokec7 section4\cf4 \strokec4 : \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 requiresSection4\cf4 \strokec4  ? [\cf9 \strokec9 'vehicleSelection'\cf4 \strokec4 ] : [],\cb1 \
\cb3     \cf7 \strokec7 section5\cf4 \strokec4 : [\cf9 \strokec9 'approvedBudget'\cf4 \strokec4 , \cf9 \strokec9 'deadlineDate'\cf4 \strokec4 ],\cb1 \
\cb3     \cf7 \strokec7 lineItemsSection\cf4 \strokec4 : [], \cf8 \strokec8 // Handled separately\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 sectionAdditionalInfo\cf4 \strokec4 : [\cf9 \strokec9 'vendor'\cf4 \strokec4 , \cf9 \strokec9 'urgencyStatus'\cf4 \strokec4 , \cf9 \strokec9 'approverSelection'\cf4 \strokec4 ]\cb1 \
\cb3   \};\cb1 \
\
\cb3   \cf8 \strokec8 // Special handling for line items section\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 sectionId\cf4 \strokec4  === \cf9 \strokec9 'lineItemsSection'\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf6 \strokec6 if\cf4 \strokec4  (!\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4  || \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  === \cf11 \strokec11 0\cf4 \strokec4 ) \cf6 \strokec6 return\cf4 \strokec4  \cf6 \strokec6 false\cf4 \strokec4 ;\cb1 \
\cb3     \cf6 \strokec6 return\cf4 \strokec4  \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4 .\cf7 \strokec7 every\cf4 \strokec4 (\cf7 \strokec7 item\cf4 \strokec4  => \cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 item\cf4 \strokec4  && \cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 qty\cf4 \strokec4  && \cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 uom\cf4 \strokec4 );\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf8 \strokec8 // For other sections, check all required fields\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 fields\cf4 \strokec4  = \cf7 \strokec7 requiredFields\cf4 \strokec4 [\cf7 \strokec7 sectionId\cf4 \strokec4 ] || [];\cb1 \
\cb3   \cf6 \strokec6 return\cf4 \strokec4  \cf7 \strokec7 fields\cf4 \strokec4 .\cf7 \strokec7 every\cf4 \strokec4 (\cf7 \strokec7 field\cf4 \strokec4  => \{\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 formData\cf4 \strokec4 [\cf7 \strokec7 field\cf4 \strokec4 ];\cb1 \
\cb3     \cf6 \strokec6 return\cf4 \strokec4  \cf7 \strokec7 value\cf4 \strokec4  && \cf7 \strokec7 value\cf4 \strokec4 .\cf7 \strokec7 toString\cf4 \strokec4 ().\cf7 \strokec7 trim\cf4 \strokec4 () !== \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3   \});\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 /**\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Updates the button color for a specific section\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  */\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 updateSectionButtonColor\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf8 \strokec8 // Only update if this section previously had errors\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 sectionsWithErrors\cf4 \strokec4 .\cf7 \strokec7 has\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4 )) \{\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 button\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 querySelector\cf4 \strokec4 (\cf9 \strokec9 `#sectionMenu button[onclick="showSection('\cf4 \strokec4 $\{\cf7 \strokec7 sectionId\cf4 \strokec4 \}\cf9 \strokec9 ')"]`\cf4 \strokec4 );\cb1 \
\cb3     \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 button\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 isValid\cf4 \strokec4  = \cf7 \strokec7 validateSection\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4 );\cb1 \
\cb3       \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 isValid\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 button\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 backgroundColor\cf4 \strokec4  = \cf9 \strokec9 'blue'\cf4 \strokec4 ;\cb1 \
\cb3         \cf7 \strokec7 button\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 color\cf4 \strokec4  = \cf9 \strokec9 'white'\cf4 \strokec4 ;\cb1 \
\cb3         \cf7 \strokec7 sectionsWithErrors\cf4 \strokec4 .\cf6 \strokec6 delete\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4 );\cb1 \
\cb3       \}\cb1 \
\cb3     \}\cb1 \
\cb3   \}\cb1 \
\cb3 \}\cb1 \
\
\
\
\
\
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: showSection(sectionId)\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Displays the input fields for the selected form section and hides the section menu.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Called when a user clicks on a section button in the section menu.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Parameters:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   - sectionId: The identifier of the section to display.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 showSection\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf7 \strokec7 currentSectionId\cf4 \strokec4  = \cf7 \strokec7 sectionId\cf4 \strokec4 ;\cb1 \
\cb3     \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementById\cf4 \strokec4 (\cf9 \strokec9 'sectionMenu'\cf4 \strokec4 ).\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 display\cf4 \strokec4  = \cf9 \strokec9 'none'\cf4 \strokec4 ;\cb1 \
\cb3     \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementById\cf4 \strokec4 (\cf9 \strokec9 'sectionContent'\cf4 \strokec4 ).\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 display\cf4 \strokec4  = \cf9 \strokec9 'block'\cf4 \strokec4 ;\cb1 \
\cb3     \cf7 \strokec7 loadSectionFields\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4 );\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: goBack()\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Returns to the section menu from the current section's input fields.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Called when a user clicks the "Back" button.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 goBack\cf4 \strokec4 () \{\cb1 \
\cb3     \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementById\cf4 \strokec4 (\cf9 \strokec9 'sectionContent'\cf4 \strokec4 ).\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 display\cf4 \strokec4  = \cf9 \strokec9 'none'\cf4 \strokec4 ;\cb1 \
\cb3     \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementById\cf4 \strokec4 (\cf9 \strokec9 'sectionMenu'\cf4 \strokec4 ).\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 display\cf4 \strokec4  = \cf9 \strokec9 'block'\cf4 \strokec4 ;\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: loadSectionFields(sectionId)\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Dynamically loads the input fields for the specified section into the sectionFields div.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Handles different sections by their identifiers.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Parameters:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   - sectionId: The identifier of the section to load fields for.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 loadSectionFields\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 sectionFieldsDiv\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementById\cf4 \strokec4 (\cf9 \strokec9 'sectionFields'\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 sectionFieldsDiv\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ; \cf8 \strokec8 // Clear previous content\cf4 \cb1 \strokec4 \
\
\cb3       \cf6 \strokec6 switch\cf4 \strokec4  (\cf7 \strokec7 sectionId\cf4 \strokec4 ) \{\cb1 \
\cb3           \cf6 \strokec6 case\cf4 \strokec4  \cf9 \strokec9 'section1'\cf4 \strokec4 :\cb1 \
\cb3               \cf8 \strokec8 // Section 1: Requestor Information\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 sectionFieldsDiv\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf9 \cb3 \strokec9                   <h3>Requestor Information</h3>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <label>Requestor Name:\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <select name="requestorName" required></select>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <label>Requestor's Department:\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <input type="text" name="department" readonly>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <label>Requestor's Email:\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <input type="email" name="requestorEmail" readonly>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <label>Request Short Description:\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <textarea name="requestShortDescription" required></textarea>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9               `\cf4 \strokec4 ;\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3               \cf8 \strokec8 // Load requestor options\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 loadRequestorOptions\cf4 \strokec4 ();\cb1 \
\
\cb3               \cf8 \strokec8 // Add the general section population call\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 setTimeout\cf4 \strokec4 (() => \cf7 \strokec7 populateFieldsFromFormData\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4 ), \cf11 \strokec11 200\cf4 \strokec4 );\cb1 \
\cb3               \cf6 \strokec6 break\cf4 \strokec4 ;\cb1 \
\
\cb3           \cf6 \strokec6 case\cf4 \strokec4  \cf9 \strokec9 'section2'\cf4 \strokec4 :\cb1 \
\cb3               \cf8 \strokec8 // Section 2: Project and Financial Details\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 sectionFieldsDiv\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf9 \cb3 \strokec9                   <h3>Project and Financial Details</h3>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <label>Project Category:\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <select name="projectCategory" required>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="">Select Project Category</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       </select>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <label>Acquiring Organization:\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <select name="acquiringOrganization" required>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="">Select Organization</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       </select>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <label>Currency:\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <select name="currency" required>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="">Select Currency</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="LSL">LSL</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="USD">USD</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="EUR">EUR</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="GBP">GBP</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="Other">Other (write-in)</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       </select>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <input type="text" name="currencyOther" placeholder="Specify other currency" style="display: none;">\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <label>Payment Format:\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <select name="paymentFormat" required>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="">Select Payment Format</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="Cash">Cash</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="EFT">EFT</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="Card">Card</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="Other">Other (write-in)</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       </select>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <input type="text" name="paymentFormatOther" placeholder="Specify other payment format" style="display: none;">\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9               `\cf4 \strokec4 ;\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3             \cb1 \
\cb3               \cf8 \strokec8 // Load options after HTML is set\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 setTimeout\cf4 \strokec4 (() => \{\cb1 \
\cb3                  \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Loading project categories...'\cf4 \strokec4 );\cb1 \
\cb3                   \cf7 \strokec7 loadProjectCategoryOptions\cf4 \strokec4 ();\cb1 \
\cb3                   \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Loading organization options...'\cf4 \strokec4 );\cb1 \
\cb3                   \cf7 \strokec7 loadOrganizationOptions\cf4 \strokec4 ();\cb1 \
\cb3               \}, \cf11 \strokec11 100\cf4 \strokec4 );\cb1 \
\
\cb3               \cf8 \strokec8 // Set up event listeners for "Other" options\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 setupCurrencyAndPaymentFormatListeners\cf4 \strokec4 ();\cb1 \
\
\cb3               \cf8 \strokec8 // Add the general section population call\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 setTimeout\cf4 \strokec4 (() => \cf7 \strokec7 populateFieldsFromFormData\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4 ), \cf11 \strokec11 200\cf4 \strokec4 );\cb1 \
\cb3               \cf6 \strokec6 break\cf4 \strokec4 ;\cb1 \
\
\cb3           \cf6 \strokec6 case\cf4 \strokec4  \cf9 \strokec9 'section3'\cf4 \strokec4 :\cb1 \
\cb3               \cf8 \strokec8 // Section 3: Location and Type\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 sectionFieldsDiv\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf9 \cb3 \strokec9                   <h3>Location and Type</h3>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <label>Site Location:\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <select name="siteLocation" required>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="">Select Site Location</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       </select>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                  <label>Expense Type:\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <select name="expenseType" required>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="">Select Expense Type</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       </select>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <label>If Expense Type is Other, please specify:\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <input type="text" name="expenseTypeOther">\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9               `\cf4 \strokec4 ;\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3               \cf8 \strokec8 // Load site location options\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 loadSiteLocationOptions\cf4 \strokec4 ();\cb1 \
\cb3               \cf8 \strokec8 // Load expense type options\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 loadExpenseTypeOptions\cf4 \strokec4 ();\cb1 \
\
\cb3               \cf8 \strokec8 // Add the general section population call\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 setTimeout\cf4 \strokec4 (() => \cf7 \strokec7 populateFieldsFromFormData\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4 ), \cf11 \strokec11 200\cf4 \strokec4 );\cb1 \
\cb3               \cf6 \strokec6 break\cf4 \strokec4 ;\cb1 \
\
\cb3           \cf6 \strokec6 case\cf4 \strokec4  \cf9 \strokec9 'section4'\cf4 \strokec4 :\cb1 \
\cb3               \cf8 \strokec8 // Section 4: Vehicle Details\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 sectionFieldsDiv\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf9 \cb3 \strokec9                   <h3>Vehicle Details</h3>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <label>Vehicle Selection:\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <select name="vehicleSelection" required>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="">Select Vehicle</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       </select>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9               `\cf4 \strokec4 ;\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3               \cf8 \strokec8 // Load vehicle options\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 loadVehicleOptions\cf4 \strokec4 ();\cb1 \
\
\cb3               \cf8 \strokec8 // Add the general section population call\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 setTimeout\cf4 \strokec4 (() => \cf7 \strokec7 populateFieldsFromFormData\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4 ), \cf11 \strokec11 200\cf4 \strokec4 );\cb1 \
\cb3               \cf6 \strokec6 break\cf4 \strokec4 ;\cb1 \
\
\cb3           \cf6 \strokec6 case\cf4 \strokec4  \cf9 \strokec9 'section5'\cf4 \strokec4 :\cb1 \
\cb3               \cf8 \strokec8 // Section 5: Budget and Timeline\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 sectionFieldsDiv\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf9 \cb3 \strokec9                   <h3>Budget and Timeline</h3>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <label>Is this part of an Approved Budget?\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <select name="approvedBudget" required>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="">Select</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="Yes">Yes</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="No">No</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="Other">Other (write-in)</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       </select>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <input type="text" name="approvedBudgetOther" placeholder="Specify other" style="display: none;">\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <label>Deadline Date:\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <input type="date" name="deadlineDate" required>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9               `\cf4 \strokec4 ;\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf4 \cb3               \cf8 \strokec8 // Add the general section population call\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 setTimeout\cf4 \strokec4 (() => \cf7 \strokec7 populateFieldsFromFormData\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4 ), \cf11 \strokec11 200\cf4 \strokec4 );\cb1 \
\cb3               \cf8 \strokec8 // Set up approved budget listener\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 setupApprovedBudgetListener\cf4 \strokec4 ();\cb1 \
\cb3               \cf6 \strokec6 break\cf4 \strokec4 ;\cb1 \
\
\cb3           \cf8 \strokec8 // Update the switch statement in loadSectionFields() to have a single lineItemsSection case:\cf4 \cb1 \strokec4 \
\cb3           \cf6 \strokec6 case\cf4 \strokec4  \cf9 \strokec9 'lineItemsSection'\cf4 \strokec4 :\cb1 \
\cb3               \cf8 \strokec8 // Section 6: Line Items\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 sectionFieldsDiv\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf9 \cb3 \strokec9                 <h3>Line Items</h3>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                 <table id="lineItemsTable">\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <thead>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                     <tr>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <th>Item</th>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <th>QTY</th>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <th>UOM [#, kg, m, etc.]</th>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <th>URL</th>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <th>Action</th>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                     </tr>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </thead>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <tbody id="lineItemsTableBody">\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </tbody>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                 </table>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                 <button type="button" onclick="addLineItemRow()">Add Line Item</button>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9               `\cf4 \strokec4 ;\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf4 \cb3               \cf8 \strokec8 // Populate existing line items or add empty row if none exist\cf4 \cb1 \strokec4 \
\cb3               \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 tbody\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementById\cf4 \strokec4 (\cf9 \strokec9 'lineItemsTableBody'\cf4 \strokec4 );\cb1 \
\cb3               \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4  && \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf11 \strokec11 0\cf4 \strokec4 ) \{\cb1 \
\cb3                   \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 ((\cf7 \strokec7 item\cf4 \strokec4 , \cf7 \strokec7 index\cf4 \strokec4 ) => \{\cb1 \
\cb3                       \cf7 \strokec7 addLineItemRow\cf4 \strokec4 ();\cb1 \
\cb3                       \cf7 \strokec7 setInputValue\cf4 \strokec4 (\cf9 \strokec9 `item_\cf4 \strokec4 $\{\cf7 \strokec7 index\cf4 \strokec4 \}\cf9 \strokec9 `\cf4 \strokec4 , \cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 item\cf4 \strokec4 );\cb1 \
\cb3                       \cf7 \strokec7 setInputValue\cf4 \strokec4 (\cf9 \strokec9 `qty_\cf4 \strokec4 $\{\cf7 \strokec7 index\cf4 \strokec4 \}\cf9 \strokec9 `\cf4 \strokec4 , \cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 qty\cf4 \strokec4 );\cb1 \
\cb3                       \cf7 \strokec7 setInputValue\cf4 \strokec4 (\cf9 \strokec9 `uom_\cf4 \strokec4 $\{\cf7 \strokec7 index\cf4 \strokec4 \}\cf9 \strokec9 `\cf4 \strokec4 , \cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 uom\cf4 \strokec4 );\cb1 \
\cb3                       \cf7 \strokec7 setInputValue\cf4 \strokec4 (\cf9 \strokec9 `url_\cf4 \strokec4 $\{\cf7 \strokec7 index\cf4 \strokec4 \}\cf9 \strokec9 `\cf4 \strokec4 , \cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 url\cf4 \strokec4 );\cb1 \
\cb3                   \});\cb1 \
\cb3               \} \cf6 \strokec6 else\cf4 \strokec4  \{\cb1 \
\cb3                   \cf8 \strokec8 // Add one empty row if no existing items\cf4 \cb1 \strokec4 \
\cb3                   \cf7 \strokec7 addLineItemRow\cf4 \strokec4 ();\cb1 \
\cb3               \}\cb1 \
\
\cb3               \cf8 \strokec8 // Add the general section population call\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 setTimeout\cf4 \strokec4 (() => \cf7 \strokec7 populateFieldsFromFormData\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4 ), \cf11 \strokec11 200\cf4 \strokec4 );\cb1 \
\cb3               \cf6 \strokec6 break\cf4 \strokec4 ;\cb1 \
\
\cb3           \cf6 \strokec6 case\cf4 \strokec4  \cf9 \strokec9 'sectionAdditionalInfo'\cf4 \strokec4 :\cb1 \
\cb3               \cf8 \strokec8 // Section 7: Additional Information\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 sectionFieldsDiv\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf9 \cb3 \strokec9                   <h3>Additional Information</h3>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <label>Vendor:\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <select name="vendor" required>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="">Select Vendor</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       </select>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <label>If Vendor is Other, please specify:\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <input type="text" name="vendorOther">\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <label>Urgency Status:\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <select name="urgencyStatus" required>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="">Select</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="Normal">Normal</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="Urgent">Urgent</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       </select>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <label>Approver Selection:\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       <select name="approverSelection" required>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                           <option value="">Select Approver</option>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                       </select>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   \cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   <label>Requestor Notes:\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                      <textarea name="requestorNotes"></textarea>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9                   </label><br><br>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9               `\cf4 \strokec4 ;\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf4 \cb3              \cf8 \strokec8 // Load dropdowns after HTML is set\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 setTimeout\cf4 \strokec4 (() => \{\cb1 \
\cb3                   \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Loading vendor options...'\cf4 \strokec4 );\cb1 \
\cb3                   \cf7 \strokec7 loadVendorOptions\cf4 \strokec4 ();\cb1 \
\cb3                   \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Loading approver options...'\cf4 \strokec4 );\cb1 \
\cb3                   \cf7 \strokec7 loadApproverOptions\cf4 \strokec4 ();\cb1 \
\cb3              \}, \cf11 \strokec11 100\cf4 \strokec4 );\cb1 \
\
\
\cb3               \cf7 \strokec7 setTimeout\cf4 \strokec4 (() => \cf7 \strokec7 populateFieldsFromFormData\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4 ), \cf11 \strokec11 200\cf4 \strokec4 );\cb1 \
\
\cb3               \cf8 \strokec8 // Add debug logs\cf4 \cb1 \strokec4 \
\cb3               \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Section 7 loaded'\cf4 \strokec4 );\cb1 \
\cb3               \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Approver select element exists:'\cf4 \strokec4 , !!\cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'approverSelection'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ]);\cb1 \
\cb3               \cf6 \strokec6 break\cf4 \strokec4 ;\cb1 \
\
\cb3          \cf6 \strokec6 default\cf4 \strokec4 :\cb1 \
\cb3               \cf7 \strokec7 sectionFieldsDiv\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `<p>Section not found.</p>`\cf4 \strokec4 ;\cb1 \
\cb3               \cf6 \strokec6 break\cf4 \strokec4 ;\cb1 \
\cb3       \}\cb1 \
\cb3       \cf7 \strokec7 addValidationToSection\cf4 \strokec4 ();\cb1 \
\cb3   \}\cb1 \
\
\
\cb3   \cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 /**\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2 * Populates form fields with existing data from formData\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2 * Called after section fields are loaded\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2 * @param \{string\} sectionId - The ID of the current section\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2 */\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 populateFieldsFromFormData\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf8 \strokec8 // Exit if no formData exists\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 if\cf4 \strokec4  (!\cf7 \strokec7 formData\cf4 \strokec4 ) \cf6 \strokec6 return\cf4 \strokec4 ;\cb1 \
\
\cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 sectionFields\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementById\cf4 \strokec4 (\cf9 \strokec9 'sectionFields'\cf4 \strokec4 );\cb1 \
\cb3   \cf6 \strokec6 if\cf4 \strokec4  (!\cf7 \strokec7 sectionFields\cf4 \strokec4 ) \cf6 \strokec6 return\cf4 \strokec4 ;\cb1 \
\
\cb3   \cf6 \strokec6 switch\cf4 \strokec4  (\cf7 \strokec7 sectionId\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf6 \strokec6 case\cf4 \strokec4  \cf9 \strokec9 'section1'\cf4 \strokec4 :\cb1 \
\cb3       \cf8 \strokec8 // Populate Requestor Information\cf4 \cb1 \strokec4 \
\cb3       \cf7 \strokec7 setSelectValue\cf4 \strokec4 (\cf9 \strokec9 'requestorName'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 requestorName\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 setInputValue\cf4 \strokec4 (\cf9 \strokec9 'department'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 department\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 setInputValue\cf4 \strokec4 (\cf9 \strokec9 'requestorEmail'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 requestorEmail\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 setInputValue\cf4 \strokec4 (\cf9 \strokec9 'requestShortDescription'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 requestShortDescription\cf4 \strokec4 );\cb1 \
\cb3       \cf6 \strokec6 break\cf4 \strokec4 ;\cb1 \
\
\cb3     \cf6 \strokec6 case\cf4 \strokec4  \cf9 \strokec9 'section2'\cf4 \strokec4 :\cb1 \
\cb3       \cf8 \strokec8 // Populate Project and Financial Details\cf4 \cb1 \strokec4 \
\cb3       \cf7 \strokec7 setSelectValue\cf4 \strokec4 (\cf9 \strokec9 'projectCategory'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 projectCategory\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 setSelectValue\cf4 \strokec4 (\cf9 \strokec9 'acquiringOrganization'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 acquiringOrganization\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 setSelectValue\cf4 \strokec4 (\cf9 \strokec9 'currency'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 currency\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 setSelectValue\cf4 \strokec4 (\cf9 \strokec9 'paymentFormat'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 paymentFormat\cf4 \strokec4 );\cb1 \
\cb3       \cb1 \
\cb3       \cf8 \strokec8 // Handle "Other" fields\cf4 \cb1 \strokec4 \
\cb3       \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 currency\cf4 \strokec4  === \cf9 \strokec9 'Other'\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 currencyOtherInput\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'currencyOther'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3         \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 currencyOtherInput\cf4 \strokec4 ) \{\cb1 \
\cb3           \cf7 \strokec7 currencyOtherInput\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 display\cf4 \strokec4  = \cf9 \strokec9 'inline'\cf4 \strokec4 ;\cb1 \
\cb3           \cf7 \strokec7 currencyOtherInput\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 currencyOther\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3         \}\cb1 \
\cb3       \}\cb1 \
\cb3       \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 paymentFormat\cf4 \strokec4  === \cf9 \strokec9 'Other'\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 paymentFormatOtherInput\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'paymentFormatOther'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3         \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 paymentFormatOtherInput\cf4 \strokec4 ) \{\cb1 \
\cb3           \cf7 \strokec7 paymentFormatOtherInput\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 display\cf4 \strokec4  = \cf9 \strokec9 'inline'\cf4 \strokec4 ;\cb1 \
\cb3           \cf7 \strokec7 paymentFormatOtherInput\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 paymentFormatOther\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3         \}\cb1 \
\cb3       \}\cb1 \
\cb3       \cf6 \strokec6 break\cf4 \strokec4 ;\cb1 \
\
\cb3     \cf6 \strokec6 case\cf4 \strokec4  \cf9 \strokec9 'section3'\cf4 \strokec4 :\cb1 \
\cb3       \cf8 \strokec8 // Populate Location and Type\cf4 \cb1 \strokec4 \
\cb3       \cf7 \strokec7 setSelectValue\cf4 \strokec4 (\cf9 \strokec9 'siteLocation'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 siteLocation\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 setSelectValue\cf4 \strokec4 (\cf9 \strokec9 'expenseType'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 expenseType\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 setInputValue\cf4 \strokec4 (\cf9 \strokec9 'expenseTypeOther'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 expenseTypeOther\cf4 \strokec4 );\cb1 \
\cb3       \cf6 \strokec6 break\cf4 \strokec4 ;\cb1 \
\
\cb3     \cf6 \strokec6 case\cf4 \strokec4  \cf9 \strokec9 'section4'\cf4 \strokec4 :\cb1 \
\cb3       \cf8 \strokec8 // Populate Vehicle Details if section is required\cf4 \cb1 \strokec4 \
\cb3       \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 requiresSection4\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 setSelectValue\cf4 \strokec4 (\cf9 \strokec9 'vehicleSelection'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 vehicleSelection\cf4 \strokec4 );\cb1 \
\cb3       \}\cb1 \
\cb3       \cf6 \strokec6 break\cf4 \strokec4 ;\cb1 \
\
\cb3     \cf6 \strokec6 case\cf4 \strokec4  \cf9 \strokec9 'section5'\cf4 \strokec4 :\cb1 \
\cb3       \cf8 \strokec8 // Populate Budget and Timeline\cf4 \cb1 \strokec4 \
\cb3       \cf7 \strokec7 setSelectValue\cf4 \strokec4 (\cf9 \strokec9 'approvedBudget'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 approvedBudget\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 setInputValue\cf4 \strokec4 (\cf9 \strokec9 'deadlineDate'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 deadlineDate\cf4 \strokec4 );\cb1 \
\cb3       \cb1 \
\cb3       \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 approvedBudget\cf4 \strokec4  === \cf9 \strokec9 'Other'\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 approvedBudgetOtherInput\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'approvedBudgetOther'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3         \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 approvedBudgetOtherInput\cf4 \strokec4 ) \{\cb1 \
\cb3           \cf7 \strokec7 approvedBudgetOtherInput\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 display\cf4 \strokec4  = \cf9 \strokec9 'inline'\cf4 \strokec4 ;\cb1 \
\cb3           \cf7 \strokec7 approvedBudgetOtherInput\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 approvedBudgetOther\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3         \}\cb1 \
\cb3       \}\cb1 \
\cb3       \cf6 \strokec6 break\cf4 \strokec4 ;\cb1 \
\
\cb3     \cf6 \strokec6 case\cf4 \strokec4  \cf9 \strokec9 'lineItemsSection'\cf4 \strokec4 :\cb1 \
\cb3       \cf8 \strokec8 // Populate Line Items\cf4 \cb1 \strokec4 \
\cb3       \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4  && \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf11 \strokec11 0\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 tbody\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementById\cf4 \strokec4 (\cf9 \strokec9 'lineItemsTableBody'\cf4 \strokec4 );\cb1 \
\cb3         \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 tbody\cf4 \strokec4 ) \{\cb1 \
\cb3           \cf7 \strokec7 tbody\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ; \cf8 \strokec8 // Clear existing rows\cf4 \cb1 \strokec4 \
\cb3           \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 ((\cf7 \strokec7 item\cf4 \strokec4 , \cf7 \strokec7 index\cf4 \strokec4 ) => \{\cb1 \
\cb3             \cf7 \strokec7 addLineItemRow\cf4 \strokec4 (); \cf8 \strokec8 // Add a new row\cf4 \cb1 \strokec4 \
\cb3             \cf7 \strokec7 setInputValue\cf4 \strokec4 (\cf9 \strokec9 `item_\cf4 \strokec4 $\{\cf7 \strokec7 index\cf4 \strokec4 \}\cf9 \strokec9 `\cf4 \strokec4 , \cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 item\cf4 \strokec4 );\cb1 \
\cb3             \cf7 \strokec7 setInputValue\cf4 \strokec4 (\cf9 \strokec9 `qty_\cf4 \strokec4 $\{\cf7 \strokec7 index\cf4 \strokec4 \}\cf9 \strokec9 `\cf4 \strokec4 , \cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 qty\cf4 \strokec4 );\cb1 \
\cb3             \cf7 \strokec7 setInputValue\cf4 \strokec4 (\cf9 \strokec9 `uom_\cf4 \strokec4 $\{\cf7 \strokec7 index\cf4 \strokec4 \}\cf9 \strokec9 `\cf4 \strokec4 , \cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 uom\cf4 \strokec4 );\cb1 \
\cb3             \cf7 \strokec7 setInputValue\cf4 \strokec4 (\cf9 \strokec9 `url_\cf4 \strokec4 $\{\cf7 \strokec7 index\cf4 \strokec4 \}\cf9 \strokec9 `\cf4 \strokec4 , \cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 url\cf4 \strokec4 );\cb1 \
\cb3           \});\cb1 \
\cb3         \}\cb1 \
\cb3       \}\cb1 \
\cb3       \cf6 \strokec6 break\cf4 \strokec4 ;\cb1 \
\
\cb3     \cf6 \strokec6 case\cf4 \strokec4  \cf9 \strokec9 'sectionAdditionalInfo'\cf4 \strokec4 :\cb1 \
\cb3       \cf8 \strokec8 // Populate Additional Information\cf4 \cb1 \strokec4 \
\cb3       \cf7 \strokec7 setSelectValue\cf4 \strokec4 (\cf9 \strokec9 'vendor'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 vendor\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 setInputValue\cf4 \strokec4 (\cf9 \strokec9 'vendorOther'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 vendorOther\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 setSelectValue\cf4 \strokec4 (\cf9 \strokec9 'urgencyStatus'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 urgencyStatus\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 setSelectValue\cf4 \strokec4 (\cf9 \strokec9 'approverSelection'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 approverSelection\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 setInputValue\cf4 \strokec4 (\cf9 \strokec9 'requestorNotes'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 requestorNotes\cf4 \strokec4 );\cb1 \
\cb3       \cf6 \strokec6 break\cf4 \strokec4 ;\cb1 \
\cb3   \}\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 /**\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Helper function to set value of a select element\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * @param \{string\} name - The name attribute of the select element\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * @param \{string\} value - The value to set\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  */\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 setSelectValue\cf4 \strokec4 (\cf7 \strokec7 name\cf4 \strokec4 , \cf7 \strokec7 value\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 element\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf7 \strokec7 name\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3   \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 element\cf4 \strokec4  && \cf7 \strokec7 value\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf8 \strokec8 // Wait for options to be populated if needed\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 setTimeout\cf4 \strokec4 (() => \{\cb1 \
\cb3       \cf7 \strokec7 element\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 value\cf4 \strokec4 ;\cb1 \
\cb3       \cf8 \strokec8 // Trigger change event for selects that have dependent fields\cf4 \cb1 \strokec4 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 event\cf4 \strokec4  = \cf6 \strokec6 new\cf4 \strokec4  \cf10 \strokec10 Event\cf4 \strokec4 (\cf9 \strokec9 'change'\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 element\cf4 \strokec4 .\cf7 \strokec7 dispatchEvent\cf4 \strokec4 (\cf7 \strokec7 event\cf4 \strokec4 );\cb1 \
\cb3     \}, \cf11 \strokec11 100\cf4 \strokec4 );\cb1 \
\cb3   \}\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 /**\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Helper function to set value of an input or textarea element\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * @param \{string\} name - The name attribute of the input element\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * @param \{string\} value - The value to set\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  */\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 setInputValue\cf4 \strokec4 (\cf7 \strokec7 name\cf4 \strokec4 , \cf7 \strokec7 value\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 element\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf7 \strokec7 name\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3   \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 element\cf4 \strokec4  && \cf7 \strokec7 value\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf7 \strokec7 element\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 value\cf4 \strokec4 ;\cb1 \
\cb3   \}\cb1 \
\cb3 \}\cb1 \
\
\
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: loadRequestorOptions()\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Fetches the list of active requestors from the server and populates the "Requestor Name"\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   dropdown. Also sets up an event listener to auto-populate the department and email based\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   on the selected requestor.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 loadRequestorOptions\cf4 \strokec4 () \{\cb1 \
\cb3     \cf7 \strokec7 google\cf4 \strokec4 .\cf7 \strokec7 script\cf4 \strokec4 .\cf7 \strokec7 run\cf4 \strokec4 .\cf7 \strokec7 withSuccessHandler\cf4 \strokec4 (\cf6 \strokec6 function\cf4 \strokec4 (\cf7 \strokec7 requestors\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 requestorSelect\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'requestorName'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3       \cf8 \strokec8 // Add a default option\cf4 \cb1 \strokec4 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 defaultOption\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 defaultOption\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3       \cf7 \strokec7 defaultOption\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf9 \strokec9 'Select Requestor'\cf4 \strokec4 ;\cb1 \
\cb3       \cf7 \strokec7 requestorSelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 defaultOption\cf4 \strokec4 );\cb1 \
\
\cb3       \cf8 \strokec8 // Store requestor data for later use\cf4 \cb1 \strokec4 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 requestorData\cf4 \strokec4  = \{\};\cb1 \
\
\cb3       \cf7 \strokec7 requestors\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 req\cf4 \strokec4  => \{\cb1 \
\cb3         \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 option\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3         \cf7 \strokec7 option\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 req\cf4 \strokec4 .\cf7 \strokec7 name\cf4 \strokec4 ;\cb1 \
\cb3         \cf7 \strokec7 option\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf7 \strokec7 req\cf4 \strokec4 .\cf7 \strokec7 name\cf4 \strokec4 ;\cb1 \
\cb3         \cf7 \strokec7 requestorSelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 option\cf4 \strokec4 );\cb1 \
\
\cb3         \cf8 \strokec8 // Map requestor name to department and email\cf4 \cb1 \strokec4 \
\cb3         \cf7 \strokec7 requestorData\cf4 \strokec4 [\cf7 \strokec7 req\cf4 \strokec4 .\cf7 \strokec7 name\cf4 \strokec4 ] = \{\cb1 \
\cb3           \cf7 \strokec7 department\cf4 \strokec4 : \cf7 \strokec7 req\cf4 \strokec4 .\cf7 \strokec7 department\cf4 \strokec4 ,\cb1 \
\cb3           \cf7 \strokec7 email\cf4 \strokec4 : \cf7 \strokec7 req\cf4 \strokec4 .\cf7 \strokec7 email\cf4 \cb1 \strokec4 \
\cb3         \};\cb1 \
\cb3       \});\cb1 \
\
\cb3       \cf8 \strokec8 // Event listener to auto-populate department and email when requestor changes\cf4 \cb1 \strokec4 \
\cb3       \cf7 \strokec7 requestorSelect\cf4 \strokec4 .\cf7 \strokec7 addEventListener\cf4 \strokec4 (\cf9 \strokec9 'change'\cf4 \strokec4 , \cf6 \strokec6 function\cf4 \strokec4 () \{\cb1 \
\cb3         \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 selectedName\cf4 \strokec4  = \cf6 \strokec6 this\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4 ;\cb1 \
\cb3         \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 departmentInput\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'department'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3         \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 emailInput\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'requestorEmail'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3         \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 requestorData\cf4 \strokec4 [\cf7 \strokec7 selectedName\cf4 \strokec4 ]) \{\cb1 \
\cb3           \cf7 \strokec7 departmentInput\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 requestorData\cf4 \strokec4 [\cf7 \strokec7 selectedName\cf4 \strokec4 ].\cf7 \strokec7 department\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3           \cf7 \strokec7 emailInput\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 requestorData\cf4 \strokec4 [\cf7 \strokec7 selectedName\cf4 \strokec4 ].\cf7 \strokec7 email\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3           \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 department\cf4 \strokec4  = \cf7 \strokec7 requestorData\cf4 \strokec4 [\cf7 \strokec7 selectedName\cf4 \strokec4 ].\cf7 \strokec7 department\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3           \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 requestorEmail\cf4 \strokec4  = \cf7 \strokec7 requestorData\cf4 \strokec4 [\cf7 \strokec7 selectedName\cf4 \strokec4 ].\cf7 \strokec7 email\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3         \} \cf6 \strokec6 else\cf4 \strokec4  \{\cb1 \
\cb3           \cf7 \strokec7 departmentInput\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3           \cf7 \strokec7 emailInput\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3           \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 department\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3           \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 requestorEmail\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3         \}\cb1 \
\cb3       \});\cb1 \
\cb3     \}).\cf7 \strokec7 getActiveRequestors\cf4 \strokec4 ();\cb1 \
\cb3   \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 /**\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Function to populate project category dropdown\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  */\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 loadProjectCategoryOptions\cf4 \strokec4 () \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 categorySelect\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'projectCategory'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3     \cb1 \
\cb3     \cf8 \strokec8 // Clear existing options\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 categorySelect\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cb1 \
\cb3     \cf8 \strokec8 // Add default option\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 defaultOption\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3     \cf7 \strokec7 defaultOption\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cf7 \strokec7 defaultOption\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf9 \strokec9 'Select Project Category'\cf4 \strokec4 ;\cb1 \
\cb3     \cf7 \strokec7 categorySelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 defaultOption\cf4 \strokec4 );\cb1 \
\
\cb3     \cf7 \strokec7 google\cf4 \strokec4 .\cf7 \strokec7 script\cf4 \strokec4 .\cf7 \strokec7 run\cf4 \cb1 \strokec4 \
\cb3         .\cf7 \strokec7 withSuccessHandler\cf4 \strokec4 (\cf6 \strokec6 function\cf4 \strokec4 (\cf7 \strokec7 categories\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Received categories:'\cf4 \strokec4 , \cf7 \strokec7 categories\cf4 \strokec4 );\cb1 \
\cb3             \cf6 \strokec6 if\cf4 \strokec4  (\cf10 \strokec10 Array\cf4 \strokec4 .\cf7 \strokec7 isArray\cf4 \strokec4 (\cf7 \strokec7 categories\cf4 \strokec4 )) \{\cb1 \
\cb3                 \cf7 \strokec7 categories\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 category\cf4 \strokec4  => \{\cb1 \
\cb3                     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 option\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3                     \cf7 \strokec7 option\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 category\cf4 \strokec4 ;\cb1 \
\cb3                     \cf7 \strokec7 option\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf7 \strokec7 category\cf4 \strokec4 ;\cb1 \
\cb3                     \cf7 \strokec7 categorySelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 option\cf4 \strokec4 );\cb1 \
\cb3                 \});\cb1 \
\cb3             \}\cb1 \
\cb3         \})\cb1 \
\cb3         .\cf7 \strokec7 withFailureHandler\cf4 \strokec4 (\cf6 \strokec6 function\cf4 \strokec4 (\cf7 \strokec7 error\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf9 \strokec9 'Failed to load categories:'\cf4 \strokec4 , \cf7 \strokec7 error\cf4 \strokec4 );\cb1 \
\cb3             \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 errorOption\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3             \cf7 \strokec7 errorOption\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3             \cf7 \strokec7 errorOption\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf9 \strokec9 'Error loading categories'\cf4 \strokec4 ;\cb1 \
\cb3             \cf7 \strokec7 categorySelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 errorOption\cf4 \strokec4 );\cb1 \
\cb3         \})\cb1 \
\cb3         .\cf7 \strokec7 getProjectCategories\cf4 \strokec4 ();\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 /**\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Function to populate organization dropdown\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  */\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 loadOrganizationOptions\cf4 \strokec4 () \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 orgSelect\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'acquiringOrganization'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3     \cb1 \
\cb3     \cf8 \strokec8 // Clear existing options\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 orgSelect\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cb1 \
\cb3     \cf8 \strokec8 // Add default option\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 defaultOption\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3     \cf7 \strokec7 defaultOption\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cf7 \strokec7 defaultOption\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf9 \strokec9 'Select Organization'\cf4 \strokec4 ;\cb1 \
\cb3     \cf7 \strokec7 orgSelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 defaultOption\cf4 \strokec4 );\cb1 \
\
\cb3     \cf7 \strokec7 google\cf4 \strokec4 .\cf7 \strokec7 script\cf4 \strokec4 .\cf7 \strokec7 run\cf4 \cb1 \strokec4 \
\cb3         .\cf7 \strokec7 withSuccessHandler\cf4 \strokec4 (\cf6 \strokec6 function\cf4 \strokec4 (\cf7 \strokec7 organizations\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Received organizations:'\cf4 \strokec4 , \cf7 \strokec7 organizations\cf4 \strokec4 );\cb1 \
\cb3             \cf6 \strokec6 if\cf4 \strokec4  (\cf10 \strokec10 Array\cf4 \strokec4 .\cf7 \strokec7 isArray\cf4 \strokec4 (\cf7 \strokec7 organizations\cf4 \strokec4 )) \{\cb1 \
\cb3                 \cf7 \strokec7 organizations\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 org\cf4 \strokec4  => \{\cb1 \
\cb3                     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 option\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3                     \cf7 \strokec7 option\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 org\cf4 \strokec4 ;\cb1 \
\cb3                     \cf7 \strokec7 option\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf7 \strokec7 org\cf4 \strokec4 ;\cb1 \
\cb3                     \cf7 \strokec7 orgSelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 option\cf4 \strokec4 );\cb1 \
\cb3                 \});\cb1 \
\cb3             \}\cb1 \
\cb3         \})\cb1 \
\cb3         .\cf7 \strokec7 withFailureHandler\cf4 \strokec4 (\cf6 \strokec6 function\cf4 \strokec4 (\cf7 \strokec7 error\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf9 \strokec9 'Failed to load organizations:'\cf4 \strokec4 , \cf7 \strokec7 error\cf4 \strokec4 );\cb1 \
\cb3             \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 errorOption\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3             \cf7 \strokec7 errorOption\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3             \cf7 \strokec7 errorOption\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf9 \strokec9 'Error loading organizations'\cf4 \strokec4 ;\cb1 \
\cb3             \cf7 \strokec7 orgSelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 errorOption\cf4 \strokec4 );\cb1 \
\cb3         \})\cb1 \
\cb3         .\cf7 \strokec7 getActiveOrganizations\cf4 \strokec4 ();\cb1 \
\cb3 \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: setupCurrencyAndPaymentFormatListeners()\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Sets up event listeners for the "Currency" and "Payment Format" fields to handle "Other"\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   options and display corresponding input fields.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 setupCurrencyAndPaymentFormatListeners\cf4 \strokec4 () \{\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 currencySelect\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'currency'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 currencyOtherInput\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'currencyOther'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3     \cf7 \strokec7 currencySelect\cf4 \strokec4 .\cf7 \strokec7 addEventListener\cf4 \strokec4 (\cf9 \strokec9 'change'\cf4 \strokec4 , \cf6 \strokec6 function\cf4 \strokec4 () \{\cb1 \
\cb3       \cf6 \strokec6 if\cf4 \strokec4  (\cf6 \strokec6 this\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  === \cf9 \strokec9 'Other'\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 currencyOtherInput\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 display\cf4 \strokec4  = \cf9 \strokec9 'inline'\cf4 \strokec4 ;\cb1 \
\cb3       \} \cf6 \strokec6 else\cf4 \strokec4  \{\cb1 \
\cb3         \cf7 \strokec7 currencyOtherInput\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 display\cf4 \strokec4  = \cf9 \strokec9 'none'\cf4 \strokec4 ;\cb1 \
\cb3         \cf7 \strokec7 currencyOtherInput\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3       \}\cb1 \
\cb3     \});\cb1 \
\
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 paymentFormatSelect\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'paymentFormat'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 paymentFormatOtherInput\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'paymentFormatOther'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3     \cf7 \strokec7 paymentFormatSelect\cf4 \strokec4 .\cf7 \strokec7 addEventListener\cf4 \strokec4 (\cf9 \strokec9 'change'\cf4 \strokec4 , \cf6 \strokec6 function\cf4 \strokec4 () \{\cb1 \
\cb3       \cf6 \strokec6 if\cf4 \strokec4  (\cf6 \strokec6 this\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  === \cf9 \strokec9 'Other'\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 paymentFormatOtherInput\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 display\cf4 \strokec4  = \cf9 \strokec9 'inline'\cf4 \strokec4 ;\cb1 \
\cb3       \} \cf6 \strokec6 else\cf4 \strokec4  \{\cb1 \
\cb3         \cf7 \strokec7 paymentFormatOtherInput\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 display\cf4 \strokec4  = \cf9 \strokec9 'none'\cf4 \strokec4 ;\cb1 \
\cb3         \cf7 \strokec7 paymentFormatOtherInput\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3       \}\cb1 \
\cb3     \});\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: loadSiteLocationOptions()\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Fetches the list of active sites from the server and populates the "Site Location" dropdown.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 loadSiteLocationOptions\cf4 \strokec4 () \{\cb1 \
\cb3     \cf7 \strokec7 google\cf4 \strokec4 .\cf7 \strokec7 script\cf4 \strokec4 .\cf7 \strokec7 run\cf4 \strokec4 .\cf7 \strokec7 withSuccessHandler\cf4 \strokec4 (\cf6 \strokec6 function\cf4 \strokec4 (\cf7 \strokec7 sites\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 siteSelect\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'siteLocation'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3       \cf8 \strokec8 // Add a default option\cf4 \cb1 \strokec4 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 defaultOption\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 defaultOption\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3       \cf7 \strokec7 defaultOption\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf9 \strokec9 'Select Site Location'\cf4 \strokec4 ;\cb1 \
\cb3       \cf7 \strokec7 siteSelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 defaultOption\cf4 \strokec4 );\cb1 \
\
\cb3       \cf7 \strokec7 sites\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 site\cf4 \strokec4  => \{\cb1 \
\cb3         \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 option\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3         \cf7 \strokec7 option\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 site\cf4 \strokec4 .\cf7 \strokec7 code\cf4 \strokec4  + \cf9 \strokec9 ':'\cf4 \strokec4  + \cf7 \strokec7 site\cf4 \strokec4 .\cf7 \strokec7 name\cf4 \strokec4 ;\cb1 \
\cb3         \cf7 \strokec7 option\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf7 \strokec7 site\cf4 \strokec4 .\cf7 \strokec7 name\cf4 \strokec4 ;\cb1 \
\cb3         \cf7 \strokec7 siteSelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 option\cf4 \strokec4 );\cb1 \
\cb3       \});\cb1 \
\cb3     \}).\cf7 \strokec7 getActiveSites\cf4 \strokec4 ();\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: loadExpenseTypeOptions()\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Fetches the list of active expense types from the server and populates the "Expense Type"\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   dropdown. Sets up an event listener to handle conditional logic for Section 4.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 loadExpenseTypeOptions\cf4 \strokec4 () \{\cb1 \
\cb3     \cf7 \strokec7 google\cf4 \strokec4 .\cf7 \strokec7 script\cf4 \strokec4 .\cf7 \strokec7 run\cf4 \strokec4 .\cf7 \strokec7 withSuccessHandler\cf4 \strokec4 (\cf6 \strokec6 function\cf4 \strokec4 (\cf7 \strokec7 expenseTypes\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 expenseTypeSelect\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'expenseType'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3       \cf8 \strokec8 // Clear existing options\cf4 \cb1 \strokec4 \
\cb3       \cf7 \strokec7 expenseTypeSelect\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3       \cf8 \strokec8 // Add a default option\cf4 \cb1 \strokec4 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 defaultOption\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 defaultOption\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3       \cf7 \strokec7 defaultOption\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf9 \strokec9 'Select Expense Type'\cf4 \strokec4 ;\cb1 \
\cb3       \cf7 \strokec7 expenseTypeSelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 defaultOption\cf4 \strokec4 );\cb1 \
\
\cb3       \cf7 \strokec7 expenseTypes\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 type\cf4 \strokec4  => \{\cb1 \
\cb3         \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 option\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3         \cf7 \strokec7 option\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 type\cf4 \strokec4 .\cf7 \strokec7 code\cf4 \strokec4  + \cf9 \strokec9 ':'\cf4 \strokec4  + \cf7 \strokec7 type\cf4 \strokec4 .\cf7 \strokec7 expenseType\cf4 \strokec4 ;\cb1 \
\cb3         \cf7 \strokec7 option\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf7 \strokec7 type\cf4 \strokec4 .\cf7 \strokec7 code\cf4 \strokec4  + \cf9 \strokec9 ':'\cf4 \strokec4  + \cf7 \strokec7 type\cf4 \strokec4 .\cf7 \strokec7 expenseType\cf4 \strokec4 ;\cb1 \
\cb3         \cf7 \strokec7 expenseTypeSelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 option\cf4 \strokec4 );\cb1 \
\cb3       \});\cb1 \
\cb3     \}).\cf7 \strokec7 getExpenseTypes\cf4 \strokec4 ();\cb1 \
\
\cb3     \cf8 \strokec8 // Event listener to handle conditional logic for Section 4\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 expenseTypeSelect\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'expenseType'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3     \cf7 \strokec7 expenseTypeSelect\cf4 \strokec4 .\cf7 \strokec7 addEventListener\cf4 \strokec4 (\cf9 \strokec9 'change'\cf4 \strokec4 , \cf6 \strokec6 function\cf4 \strokec4 () \{\cb1 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 selectedValue\cf4 \strokec4  = \cf6 \strokec6 this\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4 ;\cb1 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 section4Button\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 querySelector\cf4 \strokec4 (\cf9 \strokec9 '#sectionMenu button[onclick="showSection(\\'section4\\')"]'\cf4 \strokec4 );\cb1 \
\cb3       \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 selectedValue\cf4 \strokec4 .\cf7 \strokec7 startsWith\cf4 \strokec4 (\cf9 \strokec9 '4:'\cf4 \strokec4 )) \{\cb1 \
\cb3         \cf8 \strokec8 // Enable Section 4\cf4 \cb1 \strokec4 \
\cb3         \cf7 \strokec7 section4Button\cf4 \strokec4 .\cf7 \strokec7 disabled\cf4 \strokec4  = \cf6 \strokec6 false\cf4 \strokec4 ;\cb1 \
\cb3         \cf8 \strokec8 // Mark Section 4 as required\cf4 \cb1 \strokec4 \
\cb3         \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 requiresSection4\cf4 \strokec4  = \cf6 \strokec6 true\cf4 \strokec4 ;\cb1 \
\cb3       \} \cf6 \strokec6 else\cf4 \strokec4  \{\cb1 \
\cb3         \cf8 \strokec8 // Disable Section 4\cf4 \cb1 \strokec4 \
\cb3         \cf7 \strokec7 section4Button\cf4 \strokec4 .\cf7 \strokec7 disabled\cf4 \strokec4  = \cf6 \strokec6 true\cf4 \strokec4 ;\cb1 \
\cb3         \cf8 \strokec8 // Remove any data from Section 4\cf4 \cb1 \strokec4 \
\cb3         \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 requiresSection4\cf4 \strokec4  = \cf6 \strokec6 false\cf4 \strokec4 ;\cb1 \
\cb3         \cf6 \strokec6 delete\cf4 \strokec4  \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 vehicleSelection\cf4 \strokec4 ;\cb1 \
\cb3       \}\cb1 \
\cb3     \});\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: loadVehicleOptions()\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Fetches the list of active vehicles from the server and populates the "Vehicle Selection"\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   dropdown.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 loadVehicleOptions\cf4 \strokec4 () \{\cb1 \
\cb3     \cf7 \strokec7 google\cf4 \strokec4 .\cf7 \strokec7 script\cf4 \strokec4 .\cf7 \strokec7 run\cf4 \strokec4 .\cf7 \strokec7 withSuccessHandler\cf4 \strokec4 (\cf6 \strokec6 function\cf4 \strokec4 (\cf7 \strokec7 vehicles\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 vehicleSelect\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'vehicleSelection'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3       \cf8 \strokec8 // Clear existing options\cf4 \cb1 \strokec4 \
\cb3       \cf7 \strokec7 vehicleSelect\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\
\cb3       \cf8 \strokec8 // Add a default option\cf4 \cb1 \strokec4 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 defaultOption\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3       \cf7 \strokec7 defaultOption\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3       \cf7 \strokec7 defaultOption\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf9 \strokec9 'Select Vehicle'\cf4 \strokec4 ;\cb1 \
\cb3       \cf7 \strokec7 vehicleSelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 defaultOption\cf4 \strokec4 );\cb1 \
\
\cb3       \cf7 \strokec7 vehicles\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 vehicle\cf4 \strokec4  => \{\cb1 \
\cb3         \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 option\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3         \cf7 \strokec7 option\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 vehicle\cf4 \strokec4 .\cf7 \strokec7 name\cf4 \strokec4 ; \cf8 \strokec8 // Include more info if needed\cf4 \cb1 \strokec4 \
\cb3         \cf7 \strokec7 option\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf7 \strokec7 vehicle\cf4 \strokec4 .\cf7 \strokec7 name\cf4 \strokec4  + \cf9 \strokec9 ' ('\cf4 \strokec4  + \cf7 \strokec7 vehicle\cf4 \strokec4 .\cf7 \strokec7 registrationStatus\cf4 \strokec4  + \cf9 \strokec9 ')'\cf4 \strokec4 ;\cb1 \
\cb3         \cf7 \strokec7 vehicleSelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 option\cf4 \strokec4 );\cb1 \
\cb3       \});\cb1 \
\cb3     \}).\cf7 \strokec7 getActiveVehicles\cf4 \strokec4 ();\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: setupApprovedBudgetListener()\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Sets up an event listener for the "Approved Budget" field to handle the "Other" option\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   and display the corresponding input field.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 setupApprovedBudgetListener\cf4 \strokec4 () \{\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 approvedBudgetSelect\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'approvedBudget'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 approvedBudgetOtherInput\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'approvedBudgetOther'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3     \cf7 \strokec7 approvedBudgetSelect\cf4 \strokec4 .\cf7 \strokec7 addEventListener\cf4 \strokec4 (\cf9 \strokec9 'change'\cf4 \strokec4 , \cf6 \strokec6 function\cf4 \strokec4 () \{\cb1 \
\cb3       \cf6 \strokec6 if\cf4 \strokec4  (\cf6 \strokec6 this\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  === \cf9 \strokec9 'Other'\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 approvedBudgetOtherInput\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 display\cf4 \strokec4  = \cf9 \strokec9 'inline'\cf4 \strokec4 ;\cb1 \
\cb3       \} \cf6 \strokec6 else\cf4 \strokec4  \{\cb1 \
\cb3         \cf7 \strokec7 approvedBudgetOtherInput\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 display\cf4 \strokec4  = \cf9 \strokec9 'none'\cf4 \strokec4 ;\cb1 \
\cb3         \cf7 \strokec7 approvedBudgetOtherInput\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3       \}\cb1 \
\cb3     \});\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: loadVendorOptions()\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Fetches the list of approved vendors from the server and populates the "Vendor" dropdown.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf2 \strokec2 /**\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2  * Loads vendor options into dropdown\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  */\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 loadVendorOptions\cf4 \strokec4 () \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Loading vendor options...'\cf4 \strokec4 );\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 vendorSelect\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'vendor'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 vendorOtherInput\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'vendorOther'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3     \cb1 \
\cb3     \cf8 \strokec8 // Clear existing options\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 vendorSelect\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cb1 \
\cb3     \cf8 \strokec8 // Add default option\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 defaultOption\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3     \cf7 \strokec7 defaultOption\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cf7 \strokec7 defaultOption\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf9 \strokec9 'Select Vendor'\cf4 \strokec4 ;\cb1 \
\cb3     \cf7 \strokec7 vendorSelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 defaultOption\cf4 \strokec4 );\cb1 \
\
\cb3     \cf7 \strokec7 google\cf4 \strokec4 .\cf7 \strokec7 script\cf4 \strokec4 .\cf7 \strokec7 run\cf4 \cb1 \strokec4 \
\cb3         .\cf7 \strokec7 withSuccessHandler\cf4 \strokec4 (\cf6 \strokec6 function\cf4 \strokec4 (\cf7 \strokec7 vendors\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Received vendors:'\cf4 \strokec4 , \cf7 \strokec7 vendors\cf4 \strokec4 );\cb1 \
\cb3             \cf6 \strokec6 if\cf4 \strokec4  (\cf10 \strokec10 Array\cf4 \strokec4 .\cf7 \strokec7 isArray\cf4 \strokec4 (\cf7 \strokec7 vendors\cf4 \strokec4 )) \{\cb1 \
\cb3                 \cf7 \strokec7 vendors\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 vendor\cf4 \strokec4  => \{\cb1 \
\cb3                     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 option\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3                     \cf7 \strokec7 option\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 vendor\cf4 \strokec4 .\cf7 \strokec7 name\cf4 \strokec4 ;\cb1 \
\cb3                     \cf7 \strokec7 option\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf7 \strokec7 vendor\cf4 \strokec4 .\cf7 \strokec7 name\cf4 \strokec4 ;\cb1 \
\cb3                     \cf7 \strokec7 vendorSelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 option\cf4 \strokec4 );\cb1 \
\cb3                 \});\cb1 \
\
\cb3                 \cf8 \strokec8 // Add Other option\cf4 \cb1 \strokec4 \
\cb3                 \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 otherOption\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3                 \cf7 \strokec7 otherOption\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 'Other'\cf4 \strokec4 ;\cb1 \
\cb3                 \cf7 \strokec7 otherOption\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf9 \strokec9 'Other (write-in)'\cf4 \strokec4 ;\cb1 \
\cb3                 \cf7 \strokec7 vendorSelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 otherOption\cf4 \strokec4 );\cb1 \
\
\cb3                 \cf8 \strokec8 // Restore any previously selected value\cf4 \cb1 \strokec4 \
\cb3                 \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 vendor\cf4 \strokec4 ) \{\cb1 \
\cb3                     \cf7 \strokec7 vendorSelect\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 vendor\cf4 \strokec4 ;\cb1 \
\cb3                     \cf8 \strokec8 // Show/hide and restore Other input if needed\cf4 \cb1 \strokec4 \
\cb3                     \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 vendor\cf4 \strokec4  === \cf9 \strokec9 'Other'\cf4 \strokec4  && \cf7 \strokec7 vendorOtherInput\cf4 \strokec4 ) \{\cb1 \
\cb3                         \cf7 \strokec7 vendorOtherInput\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 display\cf4 \strokec4  = \cf9 \strokec9 'inline'\cf4 \strokec4 ;\cb1 \
\cb3                         \cf7 \strokec7 vendorOtherInput\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 vendorOther\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3                     \}\cb1 \
\cb3                 \}\cb1 \
\cb3             \}\cb1 \
\cb3         \})\cb1 \
\cb3         .\cf7 \strokec7 withFailureHandler\cf4 \strokec4 (\cf6 \strokec6 function\cf4 \strokec4 (\cf7 \strokec7 error\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf9 \strokec9 'Failed to load vendors:'\cf4 \strokec4 , \cf7 \strokec7 error\cf4 \strokec4 );\cb1 \
\cb3             \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 errorOption\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3             \cf7 \strokec7 errorOption\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3             \cf7 \strokec7 errorOption\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf9 \strokec9 'Error loading vendors'\cf4 \strokec4 ;\cb1 \
\cb3             \cf7 \strokec7 vendorSelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 errorOption\cf4 \strokec4 );\cb1 \
\cb3         \})\cb1 \
\cb3         .\cf7 \strokec7 getApprovedVendors\cf4 \strokec4 ();\cb1 \
\
\cb3     \cf8 \strokec8 // Add change handler for Other option\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 vendorSelect\cf4 \strokec4 .\cf7 \strokec7 addEventListener\cf4 \strokec4 (\cf9 \strokec9 'change'\cf4 \strokec4 , \cf6 \strokec6 function\cf4 \strokec4 () \{\cb1 \
\cb3         \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 vendorOtherInput\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf7 \strokec7 vendorOtherInput\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 display\cf4 \strokec4  = \cf6 \strokec6 this\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  === \cf9 \strokec9 'Other'\cf4 \strokec4  ? \cf9 \strokec9 'inline'\cf4 \strokec4  : \cf9 \strokec9 'none'\cf4 \strokec4 ;\cb1 \
\cb3             \cf6 \strokec6 if\cf4 \strokec4  (\cf6 \strokec6 this\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  !== \cf9 \strokec9 'Other'\cf4 \strokec4 ) \{\cb1 \
\cb3                 \cf7 \strokec7 vendorOtherInput\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3             \}\cb1 \
\cb3         \}\cb1 \
\cb3         \cf8 \strokec8 // Update formData\cf4 \cb1 \strokec4 \
\cb3         \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 vendor\cf4 \strokec4  = \cf6 \strokec6 this\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4 ;\cb1 \
\cb3     \});\cb1 \
\
\cb3     \cf8 \strokec8 // Add change handler for Other input\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 vendorOtherInput\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 vendorOtherInput\cf4 \strokec4 .\cf7 \strokec7 addEventListener\cf4 \strokec4 (\cf9 \strokec9 'change'\cf4 \strokec4 , \cf6 \strokec6 function\cf4 \strokec4 () \{\cb1 \
\cb3             \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 vendorOther\cf4 \strokec4  = \cf6 \strokec6 this\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4 ;\cb1 \
\cb3         \});\cb1 \
\cb3     \}\cb1 \
\cb3 \}\cb1 \
\
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: loadApproverOptions()\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Fetches the list of active approvers from the server and populates the "Approver Selection"\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   dropdown.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3  \cf2 \strokec2 /**\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2  * Test function to verify approver data loading\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  */\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 testApproverCall\cf4 \strokec4 () \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Testing approver data loading...'\cf4 \strokec4 );\cb1 \
\cb3     \cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 approverSelect\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'approverSelection'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3     \cf6 \strokec6 if\cf4 \strokec4  (!\cf7 \strokec7 approverSelect\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf9 \strokec9 'Approver select element not found!'\cf4 \strokec4 );\cb1 \
\cb3         \cf6 \strokec6 return\cf4 \strokec4 ;\cb1 \
\cb3     \}\cb1 \
\cb3     \cb1 \
\cb3     \cf7 \strokec7 google\cf4 \strokec4 .\cf7 \strokec7 script\cf4 \strokec4 .\cf7 \strokec7 run\cf4 \cb1 \strokec4 \
\cb3         .\cf7 \strokec7 withSuccessHandler\cf4 \strokec4 (\cf6 \strokec6 function\cf4 \strokec4 (\cf7 \strokec7 approvers\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Received approver data:'\cf4 \strokec4 , \cf7 \strokec7 approvers\cf4 \strokec4 );\cb1 \
\cb3             \cf7 \strokec7 alert\cf4 \strokec4 (\cf9 \strokec9 'Approvers received: '\cf4 \strokec4  + \cf10 \strokec10 JSON\cf4 \strokec4 .\cf7 \strokec7 stringify\cf4 \strokec4 (\cf7 \strokec7 approvers\cf4 \strokec4 , \cf6 \strokec6 null\cf4 \strokec4 , \cf11 \strokec11 2\cf4 \strokec4 ));\cb1 \
\cb3         \})\cb1 \
\cb3         .\cf7 \strokec7 withFailureHandler\cf4 \strokec4 (\cf6 \strokec6 function\cf4 \strokec4 (\cf7 \strokec7 error\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf9 \strokec9 'Error getting approvers:'\cf4 \strokec4 , \cf7 \strokec7 error\cf4 \strokec4 );\cb1 \
\cb3             \cf7 \strokec7 alert\cf4 \strokec4 (\cf9 \strokec9 'Error getting approvers: '\cf4 \strokec4  + \cf7 \strokec7 error\cf4 \strokec4 );\cb1 \
\cb3         \})\cb1 \
\cb3         .\cf7 \strokec7 getActiveApprovers\cf4 \strokec4 ();\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 /**\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Enhanced version of loadApproverOptions with more logging\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  */\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 loadApproverOptions\cf4 \strokec4 () \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'loadApproverOptions called'\cf4 \strokec4 );\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 approverSelect\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 'approverSelection'\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3     \cb1 \
\cb3     \cf6 \strokec6 if\cf4 \strokec4  (!\cf7 \strokec7 approverSelect\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf9 \strokec9 'approverSelection element not found!'\cf4 \strokec4 );\cb1 \
\cb3         \cf6 \strokec6 return\cf4 \strokec4 ;\cb1 \
\cb3     \}\cb1 \
\
\cb3     \cf8 \strokec8 // Clear existing options\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 while\cf4 \strokec4  (\cf7 \strokec7 approverSelect\cf4 \strokec4 .\cf7 \strokec7 firstChild\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 approverSelect\cf4 \strokec4 .\cf7 \strokec7 removeChild\cf4 \strokec4 (\cf7 \strokec7 approverSelect\cf4 \strokec4 .\cf7 \strokec7 firstChild\cf4 \strokec4 );\cb1 \
\cb3     \}\cb1 \
\cb3     \cb1 \
\cb3     \cf8 \strokec8 // Add default option\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 defaultOption\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3     \cf7 \strokec7 defaultOption\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cf7 \strokec7 defaultOption\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf9 \strokec9 'Select Approver'\cf4 \strokec4 ;\cb1 \
\cb3     \cf7 \strokec7 approverSelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 defaultOption\cf4 \strokec4 );\cb1 \
\cb3     \cb1 \
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Calling server for approvers...'\cf4 \strokec4 );\cb1 \
\cb3     \cb1 \
\cb3     \cf7 \strokec7 google\cf4 \strokec4 .\cf7 \strokec7 script\cf4 \strokec4 .\cf7 \strokec7 run\cf4 \cb1 \strokec4 \
\cb3         .\cf7 \strokec7 withSuccessHandler\cf4 \strokec4 (\cf6 \strokec6 function\cf4 \strokec4 (\cf7 \strokec7 approvers\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Received approvers:'\cf4 \strokec4 , \cf7 \strokec7 approvers\cf4 \strokec4 );\cb1 \
\cb3             \cb1 \
\cb3             \cf6 \strokec6 if\cf4 \strokec4  (!\cf10 \strokec10 Array\cf4 \strokec4 .\cf7 \strokec7 isArray\cf4 \strokec4 (\cf7 \strokec7 approvers\cf4 \strokec4 )) \{\cb1 \
\cb3                 \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf9 \strokec9 'Invalid approvers data received:'\cf4 \strokec4 , \cf7 \strokec7 approvers\cf4 \strokec4 );\cb1 \
\cb3                 \cf6 \strokec6 return\cf4 \strokec4 ;\cb1 \
\cb3             \}\cb1 \
\cb3             \cb1 \
\cb3             \cf7 \strokec7 approvers\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 ((\cf7 \strokec7 approver\cf4 \strokec4 , \cf7 \strokec7 index\cf4 \strokec4 ) => \{\cb1 \
\cb3                 \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 `Adding approver \cf4 \strokec4 $\{\cf7 \strokec7 index\cf4 \strokec4 \}\cf9 \strokec9 :`\cf4 \strokec4 , \cf7 \strokec7 approver\cf4 \strokec4 );\cb1 \
\cb3                 \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 option\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3                 \cf7 \strokec7 option\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 approver\cf4 \strokec4 .\cf7 \strokec7 name\cf4 \strokec4 ;\cb1 \
\cb3                 \cf7 \strokec7 option\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf9 \strokec9 `\cf4 \strokec4 $\{\cf7 \strokec7 approver\cf4 \strokec4 .\cf7 \strokec7 name\cf4 \strokec4 \}\cf9 \strokec9  (\cf4 \strokec4 $\{\cf7 \strokec7 approver\cf4 \strokec4 .\cf7 \strokec7 department\cf4 \strokec4 \}\cf9 \strokec9 )`\cf4 \strokec4 ;\cb1 \
\cb3                 \cf7 \strokec7 approverSelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 option\cf4 \strokec4 );\cb1 \
\cb3             \});\cb1 \
\cb3             \cb1 \
\cb3             \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Finished adding approvers. Final options count:'\cf4 \strokec4 , \cf7 \strokec7 approverSelect\cf4 \strokec4 .\cf7 \strokec7 options\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4 );\cb1 \
\cb3         \})\cb1 \
\cb3         .\cf7 \strokec7 withFailureHandler\cf4 \strokec4 (\cf6 \strokec6 function\cf4 \strokec4 (\cf7 \strokec7 error\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf9 \strokec9 'Failed to load approvers:'\cf4 \strokec4 , \cf7 \strokec7 error\cf4 \strokec4 );\cb1 \
\cb3             \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 errorOption\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'option'\cf4 \strokec4 );\cb1 \
\cb3             \cf7 \strokec7 errorOption\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3             \cf7 \strokec7 errorOption\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf9 \strokec9 'Error loading approvers'\cf4 \strokec4 ;\cb1 \
\cb3             \cf7 \strokec7 approverSelect\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 errorOption\cf4 \strokec4 );\cb1 \
\cb3         \})\cb1 \
\cb3         .\cf7 \strokec7 getActiveApprovers\cf4 \strokec4 ();\cb1 \
\cb3 \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: addLineItemRow()\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Adds a new row to the line items table in the Line Items section.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Allows users to input multiple line items dynamically.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 addLineItemRow\cf4 \strokec4 () \{\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 tbody\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementById\cf4 \strokec4 (\cf9 \strokec9 'lineItemsTableBody'\cf4 \strokec4 );\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 rowCount\cf4 \strokec4  = \cf7 \strokec7 tbody\cf4 \strokec4 .\cf7 \strokec7 rows\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4 ;\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 row\cf4 \strokec4  = \cf7 \strokec7 tbody\cf4 \strokec4 .\cf7 \strokec7 insertRow\cf4 \strokec4 ();\cb1 \
\
\cb3     \cf7 \strokec7 row\cf4 \strokec4 .\cf7 \strokec7 className\cf4 \strokec4  = \cf9 \strokec9 'line-item-row'\cf4 \strokec4 ;\cb1 \
\
\cb3     \cf8 \strokec8 // Item\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 let\cf4 \strokec4  \cf7 \strokec7 cell\cf4 \strokec4  = \cf7 \strokec7 row\cf4 \strokec4 .\cf7 \strokec7 insertCell\cf4 \strokec4 (\cf11 \strokec11 0\cf4 \strokec4 );\cb1 \
\cb3     \cf7 \strokec7 cell\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `<input type="text" name="item_\cf4 \strokec4 $\{\cf7 \strokec7 rowCount\cf4 \strokec4 \}\cf9 \strokec9 " required>`\cf4 \strokec4 ;\cb1 \
\
\cb3     \cf8 \strokec8 // QTY\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 cell\cf4 \strokec4  = \cf7 \strokec7 row\cf4 \strokec4 .\cf7 \strokec7 insertCell\cf4 \strokec4 (\cf11 \strokec11 1\cf4 \strokec4 );\cb1 \
\cb3     \cf7 \strokec7 cell\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `<input type="number" name="qty_\cf4 \strokec4 $\{\cf7 \strokec7 rowCount\cf4 \strokec4 \}\cf9 \strokec9 " required>`\cf4 \strokec4 ;\cb1 \
\
\cb3     \cf8 \strokec8 // UOM\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 cell\cf4 \strokec4  = \cf7 \strokec7 row\cf4 \strokec4 .\cf7 \strokec7 insertCell\cf4 \strokec4 (\cf11 \strokec11 2\cf4 \strokec4 );\cb1 \
\cb3     \cf7 \strokec7 cell\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `<input type="text" name="uom_\cf4 \strokec4 $\{\cf7 \strokec7 rowCount\cf4 \strokec4 \}\cf9 \strokec9 " required>`\cf4 \strokec4 ;\cb1 \
\
\cb3     \cf8 \strokec8 // URL\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 cell\cf4 \strokec4  = \cf7 \strokec7 row\cf4 \strokec4 .\cf7 \strokec7 insertCell\cf4 \strokec4 (\cf11 \strokec11 3\cf4 \strokec4 );\cb1 \
\cb3     \cf7 \strokec7 cell\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `<input type="url" name="url_\cf4 \strokec4 $\{\cf7 \strokec7 rowCount\cf4 \strokec4 \}\cf9 \strokec9 ">`\cf4 \strokec4 ;\cb1 \
\
\cb3     \cf8 \strokec8 // Action\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 cell\cf4 \strokec4  = \cf7 \strokec7 row\cf4 \strokec4 .\cf7 \strokec7 insertCell\cf4 \strokec4 (\cf11 \strokec11 4\cf4 \strokec4 );\cb1 \
\cb3     \cf7 \strokec7 cell\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `<button type="button" onclick="removeLineItemRow(this)">Remove</button>`\cf4 \strokec4 ;\cb1 \
\
\cb3     \cf7 \strokec7 updateSubmitButtonState\cf4 \strokec4 ();\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: removeLineItemRow(button)\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Removes a line item row from the line items table.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Parameters:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   - button: The "Remove" button element clicked by the user.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 removeLineItemRow\cf4 \strokec4 (\cf7 \strokec7 button\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 row\cf4 \strokec4  = \cf7 \strokec7 button\cf4 \strokec4 .\cf7 \strokec7 parentNode\cf4 \strokec4 .\cf7 \strokec7 parentNode\cf4 \strokec4 ;\cb1 \
\cb3     \cf7 \strokec7 row\cf4 \strokec4 .\cf7 \strokec7 parentNode\cf4 \strokec4 .\cf7 \strokec7 removeChild\cf4 \strokec4 (\cf7 \strokec7 row\cf4 \strokec4 );\cb1 \
\
\cb3     \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 currentSectionId\cf4 \strokec4  === \cf9 \strokec9 'lineItemsSection'\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4  = \cf7 \strokec7 collectLineItems\cf4 \strokec4 ();\cb1 \
\cb3     \}\cb1 \
\cb3     \cf7 \strokec7 updateSubmitButtonState\cf4 \strokec4 ();\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: copyToPreview()\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Collects data from the input fields in the current section and updates the submission\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   preview on the right side. Stores the data in the global formData object.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf8 \strokec8 // Replace your existing copyToPreview function with this updated version:\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 copyToPreview\cf4 \strokec4 () \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cb1 \
\cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 inputs\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 querySelectorAll\cf4 \strokec4 (\cf9 \strokec9 '#sectionFields input, #sectionFields select, #sectionFields textarea'\cf4 \strokec4 );\cb1 \
\cb3   \cf7 \strokec7 inputs\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 input\cf4 \strokec4  => \{\cb1 \
\cb3     \cf7 \strokec7 formData\cf4 \strokec4 [\cf7 \strokec7 input\cf4 \strokec4 .\cf7 \strokec7 name\cf4 \strokec4 ] = \cf7 \strokec7 input\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4 ;\cb1 \
\cb3   \});\cb1 \
\
\cb3   \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 currentSectionId\cf4 \strokec4  === \cf9 \strokec9 'lineItemsSection'\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4  = \cf7 \strokec7 collectLineItems\cf4 \strokec4 ();\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf7 \strokec7 updatePreview\cf4 \strokec4 ();\cb1 \
\cb3   \cb1 \
\cb3   \cf8 \strokec8 // Check if this section's validation state has changed\cf4 \cb1 \strokec4 \
\cb3   \cf7 \strokec7 updateSectionButtonColor\cf4 \strokec4 (\cf7 \strokec7 currentSectionId\cf4 \strokec4 );\cb1 \
\cb3   \cb1 \
\cb3   \cf8 \strokec8 // Add this line to update submit button state\cf4 \cb1 \strokec4 \
\cb3   \cf7 \strokec7 updateSubmitButtonState\cf4 \strokec4 ();\cb1 \
\cb3 \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: collectLineItems()\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Collects data from the line items table and returns an array of line item objects.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Each line item object contains item, qty, uom, and url properties.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Returns:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   - An array of line item objects.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 collectLineItems\cf4 \strokec4 () \{\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 lineItems\cf4 \strokec4  = [];\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 lineItemRows\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 querySelectorAll\cf4 \strokec4 (\cf9 \strokec9 '.line-item-row'\cf4 \strokec4 );\cb1 \
\cb3     \cf7 \strokec7 lineItemRows\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 ((\cf7 \strokec7 row\cf4 \strokec4 , \cf7 \strokec7 index\cf4 \strokec4 ) => \{\cb1 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 item\cf4 \strokec4  = \cf7 \strokec7 row\cf4 \strokec4 .\cf7 \strokec7 querySelector\cf4 \strokec4 (\cf9 \strokec9 `input[name="item_\cf4 \strokec4 $\{\cf7 \strokec7 index\cf4 \strokec4 \}\cf9 \strokec9 "]`\cf4 \strokec4 ).\cf7 \strokec7 value\cf4 \strokec4 ;\cb1 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 qty\cf4 \strokec4  = \cf7 \strokec7 row\cf4 \strokec4 .\cf7 \strokec7 querySelector\cf4 \strokec4 (\cf9 \strokec9 `input[name="qty_\cf4 \strokec4 $\{\cf7 \strokec7 index\cf4 \strokec4 \}\cf9 \strokec9 "]`\cf4 \strokec4 ).\cf7 \strokec7 value\cf4 \strokec4 ;\cb1 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 uom\cf4 \strokec4  = \cf7 \strokec7 row\cf4 \strokec4 .\cf7 \strokec7 querySelector\cf4 \strokec4 (\cf9 \strokec9 `input[name="uom_\cf4 \strokec4 $\{\cf7 \strokec7 index\cf4 \strokec4 \}\cf9 \strokec9 "]`\cf4 \strokec4 ).\cf7 \strokec7 value\cf4 \strokec4 ;\cb1 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 url\cf4 \strokec4  = \cf7 \strokec7 row\cf4 \strokec4 .\cf7 \strokec7 querySelector\cf4 \strokec4 (\cf9 \strokec9 `input[name="url_\cf4 \strokec4 $\{\cf7 \strokec7 index\cf4 \strokec4 \}\cf9 \strokec9 "]`\cf4 \strokec4 ).\cf7 \strokec7 value\cf4 \strokec4 ;\cb1 \
\cb3       \cf7 \strokec7 lineItems\cf4 \strokec4 .\cf7 \strokec7 push\cf4 \strokec4 (\{ \cf7 \strokec7 item\cf4 \strokec4 , \cf7 \strokec7 qty\cf4 \strokec4 , \cf7 \strokec7 uom\cf4 \strokec4 , \cf7 \strokec7 url\cf4 \strokec4  \});\cb1 \
\cb3     \});\cb1 \
\cb3     \cf6 \strokec6 return\cf4 \strokec4  \cf7 \strokec7 lineItems\cf4 \strokec4 ;\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: updatePreview()\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Updates the submission preview on the right side with the data collected in formData.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Highlights required fields in yellow if empty and green if filled.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 updatePreview\cf4 \strokec4 () \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 previewContent\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementById\cf4 \strokec4 (\cf9 \strokec9 'previewContent'\cf4 \strokec4 );\cb1 \
\cb3   \cb1 \
\cb3   \cf8 \strokec8 // Clear existing content\cf4 \cb1 \strokec4 \
\cb3   \cf7 \strokec7 previewContent\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3   \cb1 \
\cb3   \cf8 \strokec8 // Create top row grid for Sections 1 and 7\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 topGrid\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'div'\cf4 \strokec4 );\cb1 \
\cb3   \cf7 \strokec7 topGrid\cf4 \strokec4 .\cf7 \strokec7 className\cf4 \strokec4  = \cf9 \strokec9 'top-section-grid'\cf4 \strokec4 ;\cb1 \
\cb3   \cb1 \
\cb3   \cf8 \strokec8 // Section 1\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 section1\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'div'\cf4 \strokec4 );\cb1 \
\cb3   \cf7 \strokec7 section1\cf4 \strokec4 .\cf7 \strokec7 className\cf4 \strokec4  = \cf9 \strokec9 'top-section'\cf4 \strokec4 ;\cb1 \
\cb3   \cf7 \strokec7 section1\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf9 \cb3 \strokec9     <h3>Section 1: Requestor Information</h3>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     <p><strong>Requestor Name:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 highlightField\cf4 \strokec4 (\cf9 \strokec9 'requestorName'\cf4 \strokec4 )\}\cf9 \strokec9 </p>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     <p><strong>Department:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 highlightField\cf4 \strokec4 (\cf9 \strokec9 'department'\cf4 \strokec4 )\}\cf9 \strokec9 </p>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     <p><strong>Email:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 highlightField\cf4 \strokec4 (\cf9 \strokec9 'requestorEmail'\cf4 \strokec4 )\}\cf9 \strokec9 </p>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     <p><strong>Request Short Description:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 highlightField\cf4 \strokec4 (\cf9 \strokec9 'requestShortDescription'\cf4 \strokec4 )\}\cf9 \strokec9 </p>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9   `\cf4 \strokec4 ;\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf8 \strokec8 // Section 7\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 section7\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'div'\cf4 \strokec4 );\cb1 \
\cb3   \cf7 \strokec7 section7\cf4 \strokec4 .\cf7 \strokec7 className\cf4 \strokec4  = \cf9 \strokec9 'top-section'\cf4 \strokec4 ;\cb1 \
\cb3   \cf7 \strokec7 section7\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf9 \cb3 \strokec9     <h3>Section 7: Additional Information</h3>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     <p><strong>Vendor:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 vendor\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 \}\cf9 \strokec9 </p>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     <p><strong>If Vendor is Other:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 vendorOther\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 \}\cf9 \strokec9 </p>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     <p><strong>Urgency Status:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 urgencyStatus\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 \}\cf9 \strokec9 </p>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     <p><strong>Approver Selection:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 highlightField\cf4 \strokec4 (\cf9 \strokec9 'approverSelection'\cf4 \strokec4 )\}\cf9 \strokec9 </p>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     <p><strong>Requestor Notes:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 requestorNotes\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 \}\cf9 \strokec9 </p>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9   `\cf4 \strokec4 ;\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf8 \strokec8 // Add sections to top grid\cf4 \cb1 \strokec4 \
\cb3   \cf7 \strokec7 topGrid\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 section1\cf4 \strokec4 );\cb1 \
\cb3   \cf7 \strokec7 topGrid\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 section7\cf4 \strokec4 );\cb1 \
\cb3   \cb1 \
\cb3   \cf8 \strokec8 // Add top grid to preview\cf4 \cb1 \strokec4 \
\cb3   \cf7 \strokec7 previewContent\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 topGrid\cf4 \strokec4 );\cb1 \
\
\cb3   \cf8 \strokec8 // Create grid for Sections 2-5\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 quadGrid\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'div'\cf4 \strokec4 );\cb1 \
\cb3   \cf7 \strokec7 quadGrid\cf4 \strokec4 .\cf7 \strokec7 className\cf4 \strokec4  = \cf9 \strokec9 'quad-section-grid'\cf4 \strokec4 ;\cb1 \
\cb3   \cb1 \
\cb3   \cf8 \strokec8 // Section 2\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 section2\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'div'\cf4 \strokec4 );\cb1 \
\cb3   \cf7 \strokec7 section2\cf4 \strokec4 .\cf7 \strokec7 className\cf4 \strokec4  = \cf9 \strokec9 'quad-section'\cf4 \strokec4 ;\cb1 \
\cb3   \cf7 \strokec7 section2\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf9 \cb3 \strokec9     <h3>Section 2: Project and Financial Details</h3>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     <p><strong>Project Category:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 highlightField\cf4 \strokec4 (\cf9 \strokec9 'projectCategory'\cf4 \strokec4 )\}\cf9 \strokec9 </p>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     <p><strong>Acquiring Organization:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 highlightField\cf4 \strokec4 (\cf9 \strokec9 'acquiringOrganization'\cf4 \strokec4 )\}\cf9 \strokec9 </p>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     <p><strong>Currency:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 currency\cf4 \strokec4  === \cf9 \strokec9 'Other'\cf4 \strokec4  ? \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 currencyOther\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4  : \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 currency\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 \}\cf9 \strokec9 </p>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     <p><strong>Payment Format:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 paymentFormat\cf4 \strokec4  === \cf9 \strokec9 'Other'\cf4 \strokec4  ? \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 paymentFormatOther\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4  : \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 paymentFormat\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 \}\cf9 \strokec9 </p>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9   `\cf4 \strokec4 ;\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf8 \strokec8 // Section 3\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 section3\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'div'\cf4 \strokec4 );\cb1 \
\cb3   \cf7 \strokec7 section3\cf4 \strokec4 .\cf7 \strokec7 className\cf4 \strokec4  = \cf9 \strokec9 'quad-section'\cf4 \strokec4 ;\cb1 \
\cb3   \cf7 \strokec7 section3\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf9 \cb3 \strokec9     <h3>Section 3: Location and Type</h3>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     <p><strong>Site Location:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 siteLocation\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 \}\cf9 \strokec9 </p>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     <p><strong>Expense Type:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 highlightField\cf4 \strokec4 (\cf9 \strokec9 'expenseType'\cf4 \strokec4 )\}\cf9 \strokec9 </p>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     <p><strong>If Expense Type is Other:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 expenseTypeOther\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 \}\cf9 \strokec9 </p>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9   `\cf4 \strokec4 ;\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf8 \strokec8 // Section 4\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 section4\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'div'\cf4 \strokec4 );\cb1 \
\cb3   \cf7 \strokec7 section4\cf4 \strokec4 .\cf7 \strokec7 className\cf4 \strokec4  = \cf9 \strokec9 'quad-section'\cf4 \strokec4 ;\cb1 \
\cb3   \cf7 \strokec7 section4\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf9 \cb3 \strokec9     <h3>Section 4: Vehicle Details</h3>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     \cf4 \strokec4 $\{\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 requiresSection4\cf4 \strokec4  ? \cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3       \cf9 \strokec9 `<p><strong>Vehicle Selection:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 highlightField\cf4 \strokec4 (\cf9 \strokec9 'vehicleSelection'\cf4 \strokec4 )\}\cf9 \strokec9 </p>`\cf4 \strokec4  : \cb1 \
\cb3       \cf9 \strokec9 '<p>Section not applicable.</p>'\cf4 \strokec4 \}\cb1 \
\pard\pardeftab720\partightenfactor0
\cf9 \cb3 \strokec9   `\cf4 \strokec4 ;\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf8 \strokec8 // Section 5\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 section5\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'div'\cf4 \strokec4 );\cb1 \
\cb3   \cf7 \strokec7 section5\cf4 \strokec4 .\cf7 \strokec7 className\cf4 \strokec4  = \cf9 \strokec9 'quad-section'\cf4 \strokec4 ;\cb1 \
\cb3   \cf7 \strokec7 section5\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf9 \cb3 \strokec9     <h3>Section 5: Budget and Timeline</h3>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     <p><strong>Approved Budget:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 approvedBudget\cf4 \strokec4  === \cf9 \strokec9 'Other'\cf4 \strokec4  ? \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 approvedBudgetOther\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4  : \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 approvedBudget\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 \}\cf9 \strokec9 </p>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     <p><strong>Deadline Date:</strong> \cf4 \strokec4 $\{\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 deadlineDate\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 \}\cf9 \strokec9 </p>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9   `\cf4 \strokec4 ;\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf8 \strokec8 // Add sections to quad grid\cf4 \cb1 \strokec4 \
\cb3   \cf7 \strokec7 quadGrid\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 section2\cf4 \strokec4 );\cb1 \
\cb3   \cf7 \strokec7 quadGrid\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 section3\cf4 \strokec4 );\cb1 \
\cb3   \cf7 \strokec7 quadGrid\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 section4\cf4 \strokec4 );\cb1 \
\cb3   \cf7 \strokec7 quadGrid\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 section5\cf4 \strokec4 );\cb1 \
\cb3   \cb1 \
\cb3   \cf8 \strokec8 // Add quad grid to preview\cf4 \cb1 \strokec4 \
\cb3   \cf7 \strokec7 previewContent\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 quadGrid\cf4 \strokec4 );\cb1 \
\
\cb3   \cf8 \strokec8 // Section 6 (Line Items) - Full Width\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 section6\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 createElement\cf4 \strokec4 (\cf9 \strokec9 'div'\cf4 \strokec4 );\cb1 \
\cb3   \cf7 \strokec7 section6\cf4 \strokec4 .\cf7 \strokec7 className\cf4 \strokec4  = \cf9 \strokec9 'full-width-section'\cf4 \strokec4 ;\cb1 \
\cb3   \cf7 \strokec7 section6\cf4 \strokec4 .\cf7 \strokec7 innerHTML\cf4 \strokec4  = \cf9 \strokec9 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf9 \cb3 \strokec9     <h3>Section 6: Line Items</h3>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9     \cf4 \strokec4 $\{\cf7 \strokec7 generateLineItemsPreview\cf4 \strokec4 ()\}\cb1 \
\cf9 \cb3 \strokec9   `\cf4 \strokec4 ;\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf7 \strokec7 previewContent\cf4 \strokec4 .\cf7 \strokec7 appendChild\cf4 \strokec4 (\cf7 \strokec7 section6\cf4 \strokec4 );\cb1 \
\cb3 \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: highlightField(fieldName)\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Checks if a required field is filled and returns the field value wrapped in a span with\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   appropriate background color (yellow if empty and green if filled).\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Parameters:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   - fieldName: The name of the field to check and display.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Returns:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   - A string containing the field value wrapped in a styled span element.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 highlightField\cf4 \strokec4 (\cf7 \strokec7 fieldName\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 formData\cf4 \strokec4 [\cf7 \strokec7 fieldName\cf4 \strokec4 ] || \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 isFilled\cf4 \strokec4  = \cf7 \strokec7 value\cf4 \strokec4 .\cf7 \strokec7 trim\cf4 \strokec4 () !== \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 backgroundColor\cf4 \strokec4  = \cf7 \strokec7 isFilled\cf4 \strokec4  ? \cf9 \strokec9 '#d4edda'\cf4 \strokec4  : \cf9 \strokec9 '#fff3cd'\cf4 \strokec4 ; \cf8 \strokec8 // Green or Yellow\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 return\cf4 \strokec4  \cf9 \strokec9 `<span style="background-color: \cf4 \strokec4 $\{\cf7 \strokec7 backgroundColor\cf4 \strokec4 \}\cf9 \strokec9 ; padding: 2px 4px;">\cf4 \strokec4 $\{\cf7 \strokec7 value\cf4 \strokec4 \}\cf9 \strokec9 </span>`\cf4 \strokec4 ;\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: generateLineItemsPreview()\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Generates an HTML table representing the line items collected in formData.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Applies highlighting to required fields within line items.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Returns:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   - A string containing the HTML table of line items.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 generateLineItemsPreview\cf4 \strokec4 () \{\cb1 \
\cb3     \cf6 \strokec6 let\cf4 \strokec4  \cf7 \strokec7 lineItemsHtml\cf4 \strokec4  = \cf9 \strokec9 '<table border="1" cellpadding="5" cellspacing="0">'\cf4 \strokec4 ;\cb1 \
\cb3     \cf7 \strokec7 lineItemsHtml\cf4 \strokec4  += \cf9 \strokec9 '<tr><th>Item</th><th>QTY</th><th>UOM [#, kg, m, etc.]</th><th>URL</th></tr>'\cf4 \strokec4 ;\cb1 \
\
\cb3     \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4  && \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  > \cf11 \strokec11 0\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 ((\cf7 \strokec7 item\cf4 \strokec4 , \cf7 \strokec7 index\cf4 \strokec4 ) => \{\cb1 \
\cb3         \cf7 \strokec7 lineItemsHtml\cf4 \strokec4  += \cf9 \strokec9 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf9 \cb3 \strokec9           <tr>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9             <td>\cf4 \strokec4 $\{\cf7 \strokec7 highlightLineItemField\cf4 \strokec4 (\cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 item\cf4 \strokec4 )\}\cf9 \strokec9 </td>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9             <td>\cf4 \strokec4 $\{\cf7 \strokec7 highlightLineItemField\cf4 \strokec4 (\cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 qty\cf4 \strokec4 )\}\cf9 \strokec9 </td>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9             <td>\cf4 \strokec4 $\{\cf7 \strokec7 highlightLineItemField\cf4 \strokec4 (\cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 uom\cf4 \strokec4 )\}\cf9 \strokec9 </td>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9             <td>\cf4 \strokec4 $\{\cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 url\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 \}\cf9 \strokec9 </td>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9           </tr>\cf4 \cb1 \strokec4 \
\cf9 \cb3 \strokec9         `\cf4 \strokec4 ;\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3       \});\cb1 \
\cb3     \} \cf6 \strokec6 else\cf4 \strokec4  \{\cb1 \
\cb3       \cf7 \strokec7 lineItemsHtml\cf4 \strokec4  += \cf9 \strokec9 '<tr><td colspan="4">No line items added yet.</td></tr>'\cf4 \strokec4 ;\cb1 \
\cb3     \}\cb1 \
\
\cb3     \cf7 \strokec7 lineItemsHtml\cf4 \strokec4  += \cf9 \strokec9 '</table>'\cf4 \strokec4 ;\cb1 \
\cb3     \cf6 \strokec6 return\cf4 \strokec4  \cf7 \strokec7 lineItemsHtml\cf4 \strokec4 ;\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: highlightLineItemField(value)\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Applies highlighting to a field within a line item, similar to highlightField().\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Parameters:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   - value: The value of the field to highlight.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Returns:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   - A string containing the field value wrapped in a styled span element.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 highlightLineItemField\cf4 \strokec4 (\cf7 \strokec7 value\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 isFilled\cf4 \strokec4  = \cf7 \strokec7 value\cf4 \strokec4  && \cf7 \strokec7 value\cf4 \strokec4 .\cf7 \strokec7 toString\cf4 \strokec4 ().\cf7 \strokec7 trim\cf4 \strokec4 () !== \cf9 \strokec9 ''\cf4 \strokec4 ;\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 backgroundColor\cf4 \strokec4  = \cf7 \strokec7 isFilled\cf4 \strokec4  ? \cf9 \strokec9 '#d4edda'\cf4 \strokec4  : \cf9 \strokec9 '#fff3cd'\cf4 \strokec4 ; \cf8 \strokec8 // Green or Yellow\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 return\cf4 \strokec4  \cf9 \strokec9 `<span style="background-color: \cf4 \strokec4 $\{\cf7 \strokec7 backgroundColor\cf4 \strokec4 \}\cf9 \strokec9 ; padding: 2px 4px;">\cf4 \strokec4 $\{\cf7 \strokec7 value\cf4 \strokec4  || \cf9 \strokec9 ''\cf4 \strokec4 \}\cf9 \strokec9 </span>`\cf4 \strokec4 ;\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: submitForm()\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Sends the collected form data to the server-side processForm(data) function for validation\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   and storage. Handles the response by displaying success messages or highlighting errors.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 submitForm\cf4 \strokec4 () \{\cb1 \
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Client-side: Submit button clicked'\cf4 \strokec4 );\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 validationResult\cf4 \strokec4  = \cf7 \strokec7 validateFormBeforeSubmit\cf4 \strokec4 ();\cb1 \
\
\cb3     \cf6 \strokec6 if\cf4 \strokec4  (!\cf7 \strokec7 validationResult\cf4 \strokec4 .\cf7 \strokec7 isValid\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Client-side: Validation failed:'\cf4 \strokec4 , \cf7 \strokec7 validationResult\cf4 \strokec4 .\cf7 \strokec7 errors\cf4 \strokec4 );\cb1 \
\cb3         \cf7 \strokec7 updateValidationUI\cf4 \strokec4 (\cf7 \strokec7 validationResult\cf4 \strokec4 .\cf7 \strokec7 errors\cf4 \strokec4 );\cb1 \
\cb3         \cf7 \strokec7 alert\cf4 \strokec4 (\cf9 \strokec9 'Please fill in all required fields before submitting.'\cf4 \strokec4 );\cb1 \
\cb3         \cf6 \strokec6 return\cf4 \strokec4 ;\cb1 \
\cb3     \}\cb1 \
\
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Client-side: Form data being submitted:'\cf4 \strokec4 , \cf7 \strokec7 formData\cf4 \strokec4 );\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 submitButton\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 querySelector\cf4 \strokec4 (\cf9 \strokec9 '#rightSide button[onclick="submitForm()"]'\cf4 \strokec4 );\cb1 \
\cb3     \cf7 \strokec7 submitButton\cf4 \strokec4 .\cf7 \strokec7 disabled\cf4 \strokec4  = \cf6 \strokec6 true\cf4 \strokec4 ;\cb1 \
\
\cb3     \cf8 \strokec8 // Show loading state\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 submitButton\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf9 \strokec9 'Submitting...'\cf4 \strokec4 ;\cb1 \
\
\cb3     \cf7 \strokec7 google\cf4 \strokec4 .\cf7 \strokec7 script\cf4 \strokec4 .\cf7 \strokec7 run\cf4 \cb1 \strokec4 \
\cb3         .\cf7 \strokec7 withSuccessHandler\cf4 \strokec4 (\cf6 \strokec6 function\cf4 \strokec4 (\cf7 \strokec7 response\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Client-side: Server response:'\cf4 \strokec4 , \cf7 \strokec7 response\cf4 \strokec4 );\cb1 \
\cb3             \cf7 \strokec7 submitButton\cf4 \strokec4 .\cf7 \strokec7 disabled\cf4 \strokec4  = \cf6 \strokec6 false\cf4 \strokec4 ;\cb1 \
\cb3             \cf7 \strokec7 submitButton\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf9 \strokec9 'Submit'\cf4 \strokec4 ;\cb1 \
\
\cb3             \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 response\cf4 \strokec4  && \cf7 \strokec7 response\cf4 \strokec4 .\cf7 \strokec7 status\cf4 \strokec4  === \cf9 \strokec9 'success'\cf4 \strokec4 ) \{\cb1 \
\cb3                 \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Client-side: Submission successful, PR Number:'\cf4 \strokec4 , \cf7 \strokec7 response\cf4 \strokec4 .\cf7 \strokec7 prNumber\cf4 \strokec4 );\cb1 \
\cb3                 \cf7 \strokec7 alert\cf4 \strokec4 (\cf9 \strokec9 'Form submitted successfully! PR Number: '\cf4 \strokec4  + \cf7 \strokec7 response\cf4 \strokec4 .\cf7 \strokec7 prNumber\cf4 \strokec4 );\cb1 \
\cb3                 \cf8 \strokec8 // Reset form data\cf4 \cb1 \strokec4 \
\cb3                 \cf7 \strokec7 formData\cf4 \strokec4  = \{ \cf7 \strokec7 requiresSection4\cf4 \strokec4 : \cf6 \strokec6 false\cf4 \strokec4  \};\cb1 \
\cb3                 \cf7 \strokec7 updatePreview\cf4 \strokec4 ();\cb1 \
\cb3                 \cf7 \strokec7 sectionsWithErrors\cf4 \strokec4 .\cf7 \strokec7 clear\cf4 \strokec4 ();\cb1 \
\cb3                 \cf8 \strokec8 // Return to section menu\cf4 \cb1 \strokec4 \
\cb3                 \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementById\cf4 \strokec4 (\cf9 \strokec9 'sectionContent'\cf4 \strokec4 ).\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 display\cf4 \strokec4  = \cf9 \strokec9 'none'\cf4 \strokec4 ;\cb1 \
\cb3                 \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementById\cf4 \strokec4 (\cf9 \strokec9 'sectionMenu'\cf4 \strokec4 ).\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 display\cf4 \strokec4  = \cf9 \strokec9 'block'\cf4 \strokec4 ;\cb1 \
\cb3             \} \cf6 \strokec6 else\cf4 \strokec4  \{\cb1 \
\cb3                 \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf9 \strokec9 'Client-side: Submission error:'\cf4 \strokec4 , \cf7 \strokec7 response\cf4 \strokec4 );\cb1 \
\cb3                 \cf7 \strokec7 alert\cf4 \strokec4 (\cf9 \strokec9 'Error submitting form: '\cf4 \strokec4  + (\cf7 \strokec7 response\cf4 \strokec4 .\cf7 \strokec7 message\cf4 \strokec4  || \cf9 \strokec9 'Unknown error'\cf4 \strokec4 ));\cb1 \
\cb3             \}\cb1 \
\cb3         \})\cb1 \
\cb3         .\cf7 \strokec7 withFailureHandler\cf4 \strokec4 (\cf6 \strokec6 function\cf4 \strokec4 (\cf7 \strokec7 error\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf9 \strokec9 'Client-side: Submission failed:'\cf4 \strokec4 , \cf7 \strokec7 error\cf4 \strokec4 );\cb1 \
\cb3             \cf7 \strokec7 submitButton\cf4 \strokec4 .\cf7 \strokec7 disabled\cf4 \strokec4  = \cf6 \strokec6 false\cf4 \strokec4 ;\cb1 \
\cb3             \cf7 \strokec7 submitButton\cf4 \strokec4 .\cf7 \strokec7 textContent\cf4 \strokec4  = \cf9 \strokec9 'Submit'\cf4 \strokec4 ;\cb1 \
\cb3             \cf7 \strokec7 alert\cf4 \strokec4 (\cf9 \strokec9 'Failed to submit form: '\cf4 \strokec4  + \cf7 \strokec7 error\cf4 \strokec4 );\cb1 \
\cb3         \})\cb1 \
\cb3         .\cf7 \strokec7 processForm\cf4 \strokec4 (\cf7 \strokec7 formData\cf4 \strokec4 );\cb1 \
\
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 'Client-side: Submit request sent to server'\cf4 \strokec4 );\cb1 \
\cb3 \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: handleValidationErrors(errors)\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Updates the section buttons to indicate which sections contain validation errors.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Called when the server-side validation fails.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Parameters:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   - errors: An array of section identifiers that failed validation.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 handleValidationErrors\cf4 \strokec4 (\cf7 \strokec7 errors\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf8 \strokec8 // Reset all section buttons to default style\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 resetSectionButtonStyles\cf4 \strokec4 ();\cb1 \
\
\cb3     \cf8 \strokec8 // Update section buttons to indicate errors\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 errors\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4  => \{\cb1 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 button\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 querySelector\cf4 \strokec4 (\cf9 \strokec9 `#sectionMenu button[onclick="showSection('\cf4 \strokec4 $\{\cf7 \strokec7 sectionId\cf4 \strokec4 \}\cf9 \strokec9 ')"]`\cf4 \strokec4 );\cb1 \
\cb3       \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 button\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 button\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 backgroundColor\cf4 \strokec4  = \cf9 \strokec9 'red'\cf4 \strokec4 ;\cb1 \
\cb3         \cf7 \strokec7 button\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 color\cf4 \strokec4  = \cf9 \strokec9 'black'\cf4 \strokec4 ;\cb1 \
\cb3       \}\cb1 \
\cb3     \});\cb1 \
\cb3     \cf7 \strokec7 alert\cf4 \strokec4 (\cf9 \strokec9 'Please correct the highlighted sections.'\cf4 \strokec4 );\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Function: resetSectionButtonStyles()\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Resets the styles of all section buttons to their default state.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 resetSectionButtonStyles\cf4 \strokec4 () \{\cb1 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 buttons\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 querySelectorAll\cf4 \strokec4 (\cf9 \strokec9 '#sectionMenu button'\cf4 \strokec4 );\cb1 \
\cb3     \cf7 \strokec7 buttons\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 button\cf4 \strokec4  => \{\cb1 \
\cb3       \cf7 \strokec7 button\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 backgroundColor\cf4 \strokec4  = \cf9 \strokec9 'blue'\cf4 \strokec4 ;\cb1 \
\cb3       \cf7 \strokec7 button\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 color\cf4 \strokec4  = \cf9 \strokec9 'white'\cf4 \strokec4 ;\cb1 \
\cb3     \});\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf2 \strokec2 /*******************************************************************************************\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2    * Event Listeners and Initializations\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    * Description:\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *   Initializes the preview, fetches the PR number, and sets up any required default states.\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2    *******************************************************************************************/\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 addEventListener\cf4 \strokec4 (\cf9 \strokec9 'DOMContentLoaded'\cf4 \strokec4 , \cf6 \strokec6 function\cf4 \strokec4 () \{\cb1 \
\cb3     \cf7 \strokec7 updatePreview\cf4 \strokec4 ();\cb1 \
\
\cb3     \cf8 \strokec8 // Fetch and display the PR number\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 google\cf4 \strokec4 .\cf7 \strokec7 script\cf4 \strokec4 .\cf7 \strokec7 run\cf4 \strokec4 .\cf7 \strokec7 withSuccessHandler\cf4 \strokec4 (\cf6 \strokec6 function\cf4 \strokec4 (\cf7 \strokec7 prNumber\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementById\cf4 \strokec4 (\cf9 \strokec9 'prNumber'\cf4 \strokec4 ).\cf7 \strokec7 textContent\cf4 \strokec4  = \cf7 \strokec7 prNumber\cf4 \strokec4 ;\cb1 \
\cb3       \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 prNumber\cf4 \strokec4  = \cf7 \strokec7 prNumber\cf4 \strokec4 ; \cf8 \strokec8 // Store in formData if needed\cf4 \cb1 \strokec4 \
\cb3     \}).\cf7 \strokec7 getPRNumber\cf4 \strokec4 ();\cb1 \
\
\cb3     \cf8 \strokec8 // Disable Section 4 button by default\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 section4Button\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 querySelector\cf4 \strokec4 (\cf9 \strokec9 '#sectionMenu button[onclick="showSection(\\'section4\\')"]'\cf4 \strokec4 );\cb1 \
\cb3     \cf7 \strokec7 section4Button\cf4 \strokec4 .\cf7 \strokec7 disabled\cf4 \strokec4  = \cf6 \strokec6 true\cf4 \strokec4 ;\cb1 \
\
\cb3     \cf7 \strokec7 updateSubmitButtonState\cf4 \strokec4 (); \cf8 \strokec8 // Initial state\cf4 \cb1 \strokec4 \
\cb3   \});\cb1 \
\
\cb3   \cf2 \strokec2 /**\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2  * Checks if all required fields are complete\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * @returns \{boolean\} Whether all required fields are filled\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  */\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 checkAllFieldsComplete\cf4 \strokec4 () \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 requiredFields\cf4 \strokec4  = \{\cb1 \
\cb3     \cf7 \strokec7 section1\cf4 \strokec4 : [\cf9 \strokec9 'requestorName'\cf4 \strokec4 , \cf9 \strokec9 'department'\cf4 \strokec4 , \cf9 \strokec9 'requestorEmail'\cf4 \strokec4 , \cf9 \strokec9 'requestShortDescription'\cf4 \strokec4 ],\cb1 \
\cb3     \cf7 \strokec7 section2\cf4 \strokec4 : [\cf9 \strokec9 'projectCategory'\cf4 \strokec4 , \cf9 \strokec9 'acquiringOrganization'\cf4 \strokec4 , \cf9 \strokec9 'currency'\cf4 \strokec4 , \cf9 \strokec9 'paymentFormat'\cf4 \strokec4 ],\cb1 \
\cb3     \cf7 \strokec7 section3\cf4 \strokec4 : [\cf9 \strokec9 'siteLocation'\cf4 \strokec4 , \cf9 \strokec9 'expenseType'\cf4 \strokec4 ],\cb1 \
\cb3     \cf7 \strokec7 section4\cf4 \strokec4 : \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 requiresSection4\cf4 \strokec4  ? [\cf9 \strokec9 'vehicleSelection'\cf4 \strokec4 ] : [],\cb1 \
\cb3     \cf7 \strokec7 section5\cf4 \strokec4 : [\cf9 \strokec9 'approvedBudget'\cf4 \strokec4 , \cf9 \strokec9 'deadlineDate'\cf4 \strokec4 ],\cb1 \
\cb3     \cf7 \strokec7 sectionAdditionalInfo\cf4 \strokec4 : [\cf9 \strokec9 'vendor'\cf4 \strokec4 , \cf9 \strokec9 'urgencyStatus'\cf4 \strokec4 , \cf9 \strokec9 'approverSelection'\cf4 \strokec4 ]\cb1 \
\cb3   \};\cb1 \
\
\cb3   \cf8 \strokec8 // Check all regular fields\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 for\cf4 \strokec4  (\cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 section\cf4 \strokec4  \cf6 \strokec6 in\cf4 \strokec4  \cf7 \strokec7 requiredFields\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf6 \strokec6 for\cf4 \strokec4  (\cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 field\cf4 \strokec4  \cf6 \strokec6 of\cf4 \strokec4  \cf7 \strokec7 requiredFields\cf4 \strokec4 [\cf7 \strokec7 section\cf4 \strokec4 ]) \{\cb1 \
\cb3       \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 formData\cf4 \strokec4 [\cf7 \strokec7 field\cf4 \strokec4 ];\cb1 \
\cb3       \cf6 \strokec6 if\cf4 \strokec4  (!\cf7 \strokec7 value\cf4 \strokec4  || \cf7 \strokec7 value\cf4 \strokec4 .\cf7 \strokec7 toString\cf4 \strokec4 ().\cf7 \strokec7 trim\cf4 \strokec4 () === \cf9 \strokec9 ''\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf6 \strokec6 return\cf4 \strokec4  \cf6 \strokec6 false\cf4 \strokec4 ;\cb1 \
\cb3       \}\cb1 \
\cb3     \}\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf8 \strokec8 // Check line items\cf4 \cb1 \strokec4 \
\cb3   \cf6 \strokec6 if\cf4 \strokec4  (!\cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4  || \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4 .\cf7 \strokec7 length\cf4 \strokec4  === \cf11 \strokec11 0\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf6 \strokec6 return\cf4 \strokec4  \cf6 \strokec6 false\cf4 \strokec4 ;\cb1 \
\cb3   \}\cb1 \
\cb3   \cb1 \
\cb3   \cf6 \strokec6 for\cf4 \strokec4  (\cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 item\cf4 \strokec4  \cf6 \strokec6 of\cf4 \strokec4  \cf7 \strokec7 formData\cf4 \strokec4 .\cf7 \strokec7 lineItems\cf4 \strokec4 ) \{\cb1 \
\cb3     \cf6 \strokec6 if\cf4 \strokec4  (!\cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 item\cf4 \strokec4  || !\cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 qty\cf4 \strokec4  || !\cf7 \strokec7 item\cf4 \strokec4 .\cf7 \strokec7 uom\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf6 \strokec6 return\cf4 \strokec4  \cf6 \strokec6 false\cf4 \strokec4 ;\cb1 \
\cb3     \}\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf6 \strokec6 return\cf4 \strokec4  \cf6 \strokec6 true\cf4 \strokec4 ;\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 /**\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Updates submit button appearance based on field completion\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  */\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 updateSubmitButtonState\cf4 \strokec4 () \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 submitButton\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 querySelector\cf4 \strokec4 (\cf9 \strokec9 '#rightSide button[onclick="submitForm()"]'\cf4 \strokec4 );\cb1 \
\cb3   \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 checkAllFieldsComplete\cf4 \strokec4 ()) \{\cb1 \
\cb3     \cf7 \strokec7 submitButton\cf4 \strokec4 .\cf7 \strokec7 classList\cf4 \strokec4 .\cf7 \strokec7 add\cf4 \strokec4 (\cf9 \strokec9 'all-fields-complete'\cf4 \strokec4 );\cb1 \
\cb3   \} \cf6 \strokec6 else\cf4 \strokec4  \{\cb1 \
\cb3     \cf7 \strokec7 submitButton\cf4 \strokec4 .\cf7 \strokec7 classList\cf4 \strokec4 .\cf7 \strokec7 remove\cf4 \strokec4 (\cf9 \strokec9 'all-fields-complete'\cf4 \strokec4 );\cb1 \
\cb3   \}\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 /**\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Adds validation event listeners to the current section\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Called after loading each section's fields\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  */\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2 /**\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Adds validation event listeners to the current section\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * @throws \{Error\} If sectionFields div is not found\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  */\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 addValidationToSection\cf4 \strokec4 () \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 sectionFieldsDiv\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementById\cf4 \strokec4 (\cf9 \strokec9 'sectionFields'\cf4 \strokec4 );\cb1 \
\cb3     \cf6 \strokec6 if\cf4 \strokec4  (!\cf7 \strokec7 sectionFieldsDiv\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf9 \strokec9 'Section fields div not found'\cf4 \strokec4 );\cb1 \
\cb3         \cf6 \strokec6 return\cf4 \strokec4 ;\cb1 \
\cb3     \}\cb1 \
\
\cb3     \cf8 \strokec8 // Add input event listeners to all form elements\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 formElements\cf4 \strokec4  = \cf7 \strokec7 sectionFieldsDiv\cf4 \strokec4 .\cf7 \strokec7 querySelectorAll\cf4 \strokec4 (\cf9 \strokec9 'input, select, textarea'\cf4 \strokec4 );\cb1 \
\cb3     \cf7 \strokec7 formElements\cf4 \strokec4 .\cf7 \strokec7 forEach\cf4 \strokec4 (\cf7 \strokec7 element\cf4 \strokec4  => \{\cb1 \
\cb3         \cf8 \strokec8 // Skip read-only fields\cf4 \cb1 \strokec4 \
\cb3         \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 element\cf4 \strokec4 .\cf7 \strokec7 readOnly\cf4 \strokec4 ) \cf6 \strokec6 return\cf4 \strokec4 ;\cb1 \
\cb3         \cb1 \
\cb3         \cf7 \strokec7 element\cf4 \strokec4 .\cf7 \strokec7 addEventListener\cf4 \strokec4 (\cf9 \strokec9 'input'\cf4 \strokec4 , \cf6 \strokec6 function\cf4 \strokec4 () \{\cb1 \
\cb3             \cf8 \strokec8 // Update formData with new value\cf4 \cb1 \strokec4 \
\cb3             \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 value\cf4 \strokec4  = \cf6 \strokec6 this\cf4 \strokec4 .\cf7 \strokec7 type\cf4 \strokec4  === \cf9 \strokec9 'checkbox'\cf4 \strokec4  ? \cf6 \strokec6 this\cf4 \strokec4 .\cf7 \strokec7 checked\cf4 \strokec4  : \cf6 \strokec6 this\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4 ;\cb1 \
\cb3             \cf7 \strokec7 formData\cf4 \strokec4 [\cf6 \strokec6 this\cf4 \strokec4 .\cf7 \strokec7 name\cf4 \strokec4 ] = \cf7 \strokec7 value\cf4 \strokec4 ;\cb1 \
\cb3             \cb1 \
\cb3             \cf8 \strokec8 // Handle special cases for "Other" fields\cf4 \cb1 \strokec4 \
\cb3             \cf6 \strokec6 if\cf4 \strokec4  (\cf6 \strokec6 this\cf4 \strokec4 .\cf7 \strokec7 tagName\cf4 \strokec4  === \cf9 \strokec9 'SELECT'\cf4 \strokec4  && \cf7 \strokec7 value\cf4 \strokec4  === \cf9 \strokec9 'Other'\cf4 \strokec4 ) \{\cb1 \
\cb3                 \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 otherInput\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementsByName\cf4 \strokec4 (\cf9 \strokec9 `\cf4 \strokec4 $\{\cf6 \strokec6 this\cf4 \strokec4 .\cf7 \strokec7 name\cf4 \strokec4 \}\cf9 \strokec9 Other`\cf4 \strokec4 )[\cf11 \strokec11 0\cf4 \strokec4 ];\cb1 \
\cb3                 \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 otherInput\cf4 \strokec4 ) \{\cb1 \
\cb3                     \cf7 \strokec7 otherInput\cf4 \strokec4 .\cf7 \strokec7 style\cf4 \strokec4 .\cf7 \strokec7 display\cf4 \strokec4  = \cf9 \strokec9 'inline'\cf4 \strokec4 ;\cb1 \
\cb3                     \cf7 \strokec7 otherInput\cf4 \strokec4 .\cf7 \strokec7 required\cf4 \strokec4  = \cf6 \strokec6 true\cf4 \strokec4 ;\cb1 \
\cb3                 \}\cb1 \
\cb3             \}\cb1 \
\
\cb3             \cf8 \strokec8 // Check if this section is now valid\cf4 \cb1 \strokec4 \
\cb3             \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 isSectionValid\cf4 \strokec4  = \cf7 \strokec7 validateSection\cf4 \strokec4 (\cf7 \strokec7 currentSectionId\cf4 \strokec4 );\cb1 \
\cb3             \cb1 \
\cb3             \cf8 \strokec8 // Update section button appearance\cf4 \cb1 \strokec4 \
\cb3             \cf7 \strokec7 updateSectionButtonColor\cf4 \strokec4 (\cf7 \strokec7 currentSectionId\cf4 \strokec4 );\cb1 \
\cb3             \cb1 \
\cb3             \cf8 \strokec8 // Update submit button state\cf4 \cb1 \strokec4 \
\cb3             \cf7 \strokec7 updateSubmitButtonState\cf4 \strokec4 ();\cb1 \
\cb3             \cb1 \
\cb3             \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 `Field \cf4 \strokec4 $\{\cf6 \strokec6 this\cf4 \strokec4 .\cf7 \strokec7 name\cf4 \strokec4 \}\cf9 \strokec9  updated, section validity:`\cf4 \strokec4 , \cf7 \strokec7 isSectionValid\cf4 \strokec4 );\cb1 \
\cb3         \});\cb1 \
\cb3     \});\cb1 \
\
\cb3     \cf7 \strokec7 console\cf4 \strokec4 .\cf7 \strokec7 log\cf4 \strokec4 (\cf9 \strokec9 `Validation listeners added to \cf4 \strokec4 $\{\cf7 \strokec7 currentSectionId\cf4 \strokec4 \}\cf9 \strokec9 `\cf4 \strokec4 );\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 /**\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * Validates a specific section\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * @param \{string\} sectionId - The ID of the section to validate\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  * @returns \{boolean\} Whether the section is valid\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2  */\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf6 \cb3 \strokec6 function\cf4 \strokec4  \cf7 \strokec7 validateSection\cf4 \strokec4 (\cf7 \strokec7 sectionId\cf4 \strokec4 ) \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3     \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 sectionFields\cf4 \strokec4  = \cf7 \strokec7 document\cf4 \strokec4 .\cf7 \strokec7 getElementById\cf4 \strokec4 (\cf9 \strokec9 'sectionFields'\cf4 \strokec4 )\cb1 \
\cb3         .\cf7 \strokec7 querySelectorAll\cf4 \strokec4 (\cf9 \strokec9 'input[required], select[required], textarea[required]'\cf4 \strokec4 );\cb1 \
\cb3     \cb1 \
\cb3     \cf6 \strokec6 return\cf4 \strokec4  \cf10 \strokec10 Array\cf4 \strokec4 .\cf6 \strokec6 from\cf4 \strokec4 (\cf7 \strokec7 sectionFields\cf4 \strokec4 ).\cf7 \strokec7 every\cf4 \strokec4 (\cf7 \strokec7 field\cf4 \strokec4  => \{\cb1 \
\cb3         \cf6 \strokec6 if\cf4 \strokec4  (\cf7 \strokec7 field\cf4 \strokec4 .\cf7 \strokec7 type\cf4 \strokec4  === \cf9 \strokec9 'hidden'\cf4 \strokec4 ) \cf6 \strokec6 return\cf4 \strokec4  \cf6 \strokec6 true\cf4 \strokec4 ;\cb1 \
\cb3         \cf6 \strokec6 const\cf4 \strokec4  \cf7 \strokec7 value\cf4 \strokec4  = \cf7 \strokec7 field\cf4 \strokec4 .\cf7 \strokec7 value\cf4 \strokec4 .\cf7 \strokec7 trim\cf4 \strokec4 ();\cb1 \
\cb3         \cf6 \strokec6 return\cf4 \strokec4  \cf7 \strokec7 value\cf4 \strokec4  !== \cf9 \strokec9 ''\cf4 \strokec4  && \cf7 \strokec7 value\cf4 \strokec4  !== \cf9 \strokec9 'Select'\cf4 \strokec4 ;\cb1 \
\cb3     \});\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 </\cf6 \strokec6 script\cf5 \strokec5 >\cf4 \cb1 \strokec4 \
\
\
\
\
}